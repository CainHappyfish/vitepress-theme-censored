---
title: JavaScriptå¤ä¹ -3
layout: page
author: C4iN
cover: https://ts1.cn.mm.bing.net/th/id/R-C.535e92c65ddaff1a55f11df10c680c75?rik=f%2biBg6VYkZpFAQ&riu=http%3a%2f%2fradicalhub.com%2fwp-content%2fuploads%2f2018%2f07%2fjavascript.jpg&ehk=%2f8TEVGmLi%2bQfePoivY3xtjLzdul2sHZ8uuJe38nC3L4%3d&risl=&pid=ImgRaw&r=0
tags:
 - å‰ç«¯
 - JavaScript


---



Javascriptå¤ä¹ é€Ÿé€šç¬¬äºŒéƒ¨åˆ†ï¼Œä¸»è¦æ˜¯å¯¹JSæ•°æ®ç±»å‹æ›´è¿›ä¸€æ­¥çš„ç†è§£ã€‚

<!--more-->

æˆ‘ä»¬æ¥çœ‹çœ‹åŸå§‹ç±»å‹å’Œå¯¹è±¡ä¹‹é—´çš„å…³é”®åŒºåˆ«ã€‚

ä¸€ä¸ªåŸå§‹å€¼ï¼š

- æ˜¯åŸå§‹ç±»å‹ä¸­çš„ä¸€ç§å€¼ã€‚
- åœ¨ JavaScript ä¸­æœ‰ 7 ç§åŸå§‹ç±»å‹ï¼š`string`ï¼Œ`number`ï¼Œ`bigint`ï¼Œ`boolean`ï¼Œ`symbol`ï¼Œ`null` å’Œ `undefined`ã€‚

ä¸€ä¸ªå¯¹è±¡ï¼š

- èƒ½å¤Ÿå­˜å‚¨å¤šä¸ªå€¼ä½œä¸ºå±æ€§ã€‚
- å¯ä»¥ä½¿ç”¨å¤§æ‹¬å· `{}` åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š`{name: "John", age: 30}`ã€‚JavaScript ä¸­è¿˜æœ‰å…¶ä»–ç§ç±»çš„å¯¹è±¡ï¼Œä¾‹å¦‚å‡½æ•°å°±æ˜¯å¯¹è±¡ã€‚

å…³äºå¯¹è±¡çš„æœ€å¥½çš„äº‹å„¿ä¹‹ä¸€æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå‡½æ•°ä½œä¸ºå¯¹è±¡çš„å±æ€§å­˜å‚¨åˆ°å¯¹è±¡ä¸­ã€‚

- é™¤ `null` å’Œ `undefined` ä»¥å¤–çš„åŸå§‹ç±»å‹éƒ½æä¾›äº†è®¸å¤šæœ‰ç”¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬åé¢çš„ç« èŠ‚ä¸­å­¦ä¹ è¿™äº›å†…å®¹ã€‚
- ä»å½¢å¼ä¸Šè®²ï¼Œè¿™äº›æ–¹æ³•é€šè¿‡ä¸´æ—¶å¯¹è±¡å·¥ä½œï¼Œä½† JavaScript å¼•æ“å¯ä»¥å¾ˆå¥½åœ°è°ƒæ•´ï¼Œä»¥åœ¨å†…éƒ¨å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤è°ƒç”¨å®ƒä»¬å¹¶ä¸éœ€è¦å¤ªé«˜çš„æˆæœ¬ã€‚

# æ•°å­—ç±»å‹

è¦å†™æœ‰å¾ˆå¤šé›¶çš„æ•°å­—ï¼š

- å°† `"e"` å’Œ 0 çš„æ•°é‡é™„åŠ åˆ°æ•°å­—åã€‚å°±åƒï¼š`123e6` ä¸ `123` åé¢æ¥ 6 ä¸ª 0 ç›¸åŒã€‚
- `"e"` åé¢çš„è´Ÿæ•°å°†ä½¿æ•°å­—é™¤ä»¥ 1 åé¢æ¥ç€ç»™å®šæ•°é‡çš„é›¶çš„æ•°å­—ã€‚ä¾‹å¦‚ `123e-6` è¡¨ç¤º `0.000123`ï¼ˆ`123` çš„ç™¾ä¸‡åˆ†ä¹‹ä¸€ï¼‰ã€‚

å¯¹äºä¸åŒçš„æ•°å­—ç³»ç»Ÿï¼š

- å¯ä»¥ç›´æ¥åœ¨åå…­è¿›åˆ¶ï¼ˆ`0x`ï¼‰ï¼Œå…«è¿›åˆ¶ï¼ˆ`0o`ï¼‰å’ŒäºŒè¿›åˆ¶ï¼ˆ`0b`ï¼‰ç³»ç»Ÿä¸­å†™å…¥æ•°å­—ã€‚
- `parseInt(str, base)` å°†å­—ç¬¦ä¸² `str` è§£æä¸ºåœ¨ç»™å®šçš„ `base` æ•°å­—ç³»ç»Ÿä¸­çš„æ•´æ•°ï¼Œ`2 â‰¤ base â‰¤ 36`ã€‚
  - `parseInt()` å‡½æ•°å…·æœ‰å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚å®ƒæŒ‡å®šäº†æ•°å­—ç³»ç»Ÿçš„åŸºæ•°ï¼Œå› æ­¤ `parseInt` è¿˜å¯ä»¥è§£æåå…­è¿›åˆ¶æ•°å­—ã€äºŒè¿›åˆ¶æ•°å­—ç­‰çš„å­—ç¬¦ä¸²ã€‚
- `num.toString(base)` å°†æ•°å­—è½¬æ¢ä¸ºåœ¨ç»™å®šçš„ `base` æ•°å­—ç³»ç»Ÿä¸­çš„å­—ç¬¦ä¸²ã€‚

å¯¹äºå¸¸è§„æ•°å­—æ£€æµ‹ï¼š

- `isNaN(value)` å°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œç„¶åæ£€æµ‹å®ƒæ˜¯å¦ä¸º `NaN`
- `isFinite(value)` å°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚æœå®ƒæ˜¯å¸¸è§„æ•°å­—ï¼Œåˆ™è¿”å› `true`ï¼Œè€Œä¸æ˜¯ `NaN/Infinity/-Infinity`

è¦å°† `12pt` å’Œ `100px` ä¹‹ç±»çš„å€¼è½¬æ¢ä¸ºæ•°å­—ï¼š

- ä½¿ç”¨ `parseInt/parseFloat` è¿›è¡Œâ€œè½¯â€è½¬æ¢ï¼Œå®ƒä»å­—ç¬¦ä¸²ä¸­è¯»å–æ•°å­—ï¼Œç„¶åè¿”å›åœ¨å‘ç”Ÿ error å‰å¯ä»¥è¯»å–åˆ°çš„å€¼ã€‚

å°æ•°ï¼š

- ä½¿ç”¨ `Math.floor`ï¼Œ`Math.ceil`ï¼Œ`Math.trunc`ï¼Œ`Math.round` æˆ– `num.toFixed(precision)` è¿›è¡Œèˆå…¥ã€‚
- è¯·ç¡®ä¿è®°ä½ä½¿ç”¨å°æ•°æ—¶ä¼šæŸå¤±ç²¾åº¦ã€‚

æ›´å¤šæ•°å­¦å‡½æ•°ï¼š

- éœ€è¦æ—¶è¯·æŸ¥çœ‹ [Math](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Math) å¯¹è±¡ã€‚è¿™ä¸ªåº“å¾ˆå°ï¼Œä½†æ˜¯å¯ä»¥æ»¡è¶³åŸºæœ¬çš„éœ€æ±‚ã€‚

> ä¸ºä»€ä¹ˆ`6.35.toFixed(1)==6.3`
>
> åœ¨å†…éƒ¨ï¼Œ`6.35` çš„å°æ•°éƒ¨åˆ†æ˜¯ä¸€ä¸ªæ— é™çš„äºŒè¿›åˆ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„å­˜å‚¨ä¼šé€ æˆç²¾åº¦æŸå¤±ã€‚
>
> è®©æˆ‘ä»¬æ¥çœ‹çœ‹ï¼š
>
> ```javascript
> alert( 6.35.toFixed(20) ); // 6.34999999999999964473
> ```
>
> ç²¾åº¦æŸå¤±å¯èƒ½ä¼šå¯¼è‡´æ•°å­—çš„å¢åŠ å’Œå‡å°ã€‚åœ¨è¿™ç§ç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œæ•°å­—å˜å°äº†ä¸€ç‚¹ï¼Œè¿™å°±æ˜¯å®ƒå‘ä¸‹èˆå…¥çš„åŸå› ã€‚
>
> é‚£ä¹ˆ `1.35` ä¼šæ€æ ·å‘¢ï¼Ÿ
>
> ```javascript
> alert( 1.35.toFixed(20) ); // 1.35000000000000008882
> ```
>
> åœ¨è¿™é‡Œï¼Œç²¾åº¦æŸå¤±ä½¿å¾—è¿™ä¸ªæ•°å­—ç¨å¾®å¤§äº†ä¸€äº›ï¼Œå› æ­¤å…¶å‘ä¸Šèˆå…¥ã€‚
>
> **å¦‚æœæˆ‘ä»¬å¸Œæœ›ä»¥æ­£ç¡®çš„æ–¹å¼è¿›è¡Œèˆå…¥ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³ `6.35` çš„èˆå…¥é—®é¢˜å‘¢ï¼Ÿ**
>
> åœ¨è¿›è¡Œèˆå…¥å‰ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿å…¶æ›´æ¥è¿‘æ•´æ•°ï¼š
>
> ```javascript
> alert( (6.35 * 10).toFixed(20) ); // 63.50000000000000000000
> ```
>
> è¯·æ³¨æ„ï¼Œ`63.5` å®Œå…¨æ²¡æœ‰ç²¾åº¦æŸå¤±ã€‚è¿™æ˜¯å› ä¸ºå°æ•°éƒ¨åˆ† `0.5` å®é™…ä¸Šæ˜¯ `1/2`ã€‚ä»¥ 2 çš„æ•´æ•°æ¬¡å¹‚ä¸ºåˆ†æ¯çš„å°æ•°åœ¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­å¯ä»¥è¢«ç²¾ç¡®åœ°è¡¨ç¤ºï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œèˆå…¥ï¼š
>
> ```javascript
> alert( Math.round(6.35 * 10) / 10); // 6.35 -> 63.5 -> 64(rounded) -> 6.4
> ```
>
> éœ€è¦æ³¨æ„çš„æ˜¯`null`ï¼ˆå–æ¶ˆï¼‰å’Œç©ºè¡Œåœ¨æ•°å­—å½¢å¼ä¸­æ˜¯ `0`ã€‚

# å­—ç¬¦ä¸²

| å­—ç¬¦                                    | æè¿°                                                         |
| :-------------------------------------- | :----------------------------------------------------------- |
| `\n`                                    | æ¢è¡Œ                                                         |
| `\r`                                    | åœ¨ Windows æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ `\r\n` çš„ç»„åˆä»£è¡¨ä¸€ä¸ªæ¢è¡Œã€‚è€Œåœ¨é Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œå®ƒå°±æ˜¯ `\n`ã€‚è¿™æ˜¯å†å²åŸå› é€ æˆçš„ï¼Œå¤§å¤šæ•°çš„ Windows è½¯ä»¶ä¹Ÿç†è§£ `\n`ã€‚ |
| `\'`, `\"`                              | å¼•å·                                                         |
| `\\`                                    | åæ–œçº¿                                                       |
| `\t`                                    | åˆ¶è¡¨ç¬¦                                                       |
| `\b`, `\f`, `\v`                        | é€€æ ¼ï¼Œæ¢é¡µï¼Œå‚ç›´æ ‡ç­¾ â€”â€” ä¸ºäº†å…¼å®¹æ€§ï¼Œç°åœ¨å·²ç»ä¸ä½¿ç”¨äº†ã€‚       |
| `\xXX`                                  | å…·æœ‰ç»™å®šåå…­è¿›åˆ¶ Unicode `XX` çš„ Unicode å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š`'\x7A'` å’Œ `'z'` ç›¸åŒã€‚ |
| `\uXXXX`                                | ä»¥ UTF-16 ç¼–ç çš„åå…­è¿›åˆ¶ä»£ç  `XXXX` çš„ Unicode å­—ç¬¦ï¼Œä¾‹å¦‚ `\u00A9` â€”â€” æ˜¯ç‰ˆæƒç¬¦å· `Â©` çš„ Unicodeã€‚å®ƒå¿…é¡»æ­£å¥½æ˜¯ 4 ä¸ªåå…­è¿›åˆ¶æ•°å­—ã€‚ |
| `\u{Xâ€¦XXXXXX}`ï¼ˆ1 åˆ° 6 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰ | å…·æœ‰ç»™å®š UTF-32 ç¼–ç çš„ Unicode ç¬¦å·ã€‚ä¸€äº›ç½•è§çš„å­—ç¬¦ç”¨ä¸¤ä¸ª Unicode ç¬¦å·ç¼–ç ï¼Œå ç”¨ 4 ä¸ªå­—èŠ‚ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ’å…¥é•¿ä»£ç äº†ã€‚ |

| æ–¹æ³•                    | é€‰æ‹©æ–¹å¼â€¦â€¦                                | è´Ÿå€¼å‚æ•°            |
| :---------------------- | :---------------------------------------- | :------------------ |
| `slice(start, end)`     | ä» `start` åˆ° `end`ï¼ˆä¸å« `end`ï¼‰         | å…è®¸                |
| `substring(start, end)` | ä» `start` åˆ° `end`ï¼ˆä¸å« `end`ï¼‰         | è´Ÿå€¼è¢«è§†ä¸º `0`      |
| `substr(start, length)` | ä» `start` å¼€å§‹è·å–é•¿ä¸º `length` çš„å­—ç¬¦ä¸² | å…è®¸ `start` ä¸ºè´Ÿæ•° |

- æœ‰ 3 ç§ç±»å‹çš„å¼•å·ã€‚åå¼•å·å…è®¸å­—ç¬¦ä¸²è·¨è¶Šå¤šè¡Œå¹¶å¯ä»¥ä½¿ç”¨ `${â€¦}` åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥è¡¨è¾¾å¼ã€‚
- JavaScript ä¸­çš„å­—ç¬¦ä¸²ä½¿ç”¨çš„æ˜¯ UTF-16 ç¼–ç ã€‚
- æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åƒ `\n` è¿™æ ·çš„ç‰¹æ®Šå­—ç¬¦æˆ–é€šè¿‡ä½¿ç”¨ `\u...` æ¥æ“ä½œå®ƒä»¬çš„ Unicode è¿›è¡Œå­—ç¬¦æ’å…¥ã€‚
- è·å–å­—ç¬¦æ—¶ï¼Œä½¿ç”¨ `[]`ã€‚
- è·å–å­å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `slice` æˆ– `substring`ã€‚
- å­—ç¬¦ä¸²çš„å¤§/å°å†™è½¬æ¢ï¼Œä½¿ç”¨ï¼š`toLowerCase/toUpperCase`ã€‚
- æŸ¥æ‰¾å­å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨ `indexOf` æˆ– `includes/startsWith/endsWith` è¿›è¡Œç®€å•æ£€æŸ¥ã€‚
- æ ¹æ®è¯­è¨€æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ä½¿ç”¨ `localeCompare`ï¼Œå¦åˆ™å°†æŒ‰å­—ç¬¦ä»£ç è¿›è¡Œæ¯”è¾ƒã€‚

è¿˜æœ‰å…¶ä»–å‡ ç§æœ‰ç”¨çš„å­—ç¬¦ä¸²æ–¹æ³•ï¼š

- `str.trim()` â€”â€” åˆ é™¤å­—ç¬¦ä¸²å‰åçš„ç©ºæ ¼ (â€œtrimsâ€)ã€‚
- `str.repeat(n)` â€”â€” é‡å¤å­—ç¬¦ä¸² `n` æ¬¡ã€‚
- â€¦â€¦æ›´å¤šå†…å®¹ç»†èŠ‚è¯·å‚è§ [æ‰‹å†Œ](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String)ã€‚

# æ•°ç»„

æ•°ç»„ï¼ˆ`Array`ï¼‰å­˜å‚¨æœ‰åºçš„é›†åˆã€‚æ•°ç»„å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å…ƒç´ ã€‚ è¯·å°†æ•°ç»„è§†ä¸ºä½œç”¨äº **æœ‰åºæ•°æ®** çš„ç‰¹æ®Šç»“æ„ã€‚å®ƒä»¬ä¸ºæ­¤æä¾›äº†ç‰¹æ®Šçš„æ–¹æ³•ã€‚æ•°ç»„åœ¨ JavaScript å¼•æ“å†…éƒ¨æ˜¯ç»è¿‡ç‰¹æ®Šè°ƒæ•´çš„ï¼Œä½¿å¾—æ›´å¥½åœ°ä½œç”¨äºè¿ç»­çš„æœ‰åºæ•°æ®ï¼Œæ‰€ä»¥è¯·ä»¥æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨æ•°ç»„ã€‚å¦‚æœä½ éœ€è¦ä»»æ„é”®å€¼ï¼Œé‚£å¾ˆæœ‰å¯èƒ½å®é™…ä¸Šä½ éœ€è¦çš„æ˜¯å¸¸è§„å¯¹è±¡ `{}`ã€‚æ¸…ç©ºæ•°ç»„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ï¼š`arr.length = 0;`ã€‚

æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œé€‚ç”¨äºå­˜å‚¨å’Œç®¡ç†æœ‰åºçš„æ•°æ®é¡¹ã€‚

å£°æ˜ï¼š

```javascript
// æ–¹æ‹¬å· (å¸¸è§ç”¨æ³•)
let arr = [item1, item2...];

// new Array (æå…¶å°‘è§)
let arr = new Array(item1, item2...);
```

è°ƒç”¨ `new Array(number)` ä¼šåˆ›å»ºä¸€ä¸ªç»™å®šé•¿åº¦çš„æ•°ç»„ï¼Œä½†ä¸å«æœ‰ä»»ä½•é¡¹ã€‚

- `length` å±æ€§æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œå‡†ç¡®åœ°è¯´ï¼Œå®ƒæ˜¯æ•°ç»„æœ€åä¸€ä¸ªæ•°å­—ç´¢å¼•å€¼åŠ ä¸€ã€‚å®ƒç”±æ•°ç»„æ–¹æ³•è‡ªåŠ¨è°ƒæ•´ã€‚
- å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨ç¼©çŸ­ `length`ï¼Œé‚£ä¹ˆæ•°ç»„å°±ä¼šè¢«æˆªæ–­ã€‚

è·å–å…ƒç´ ï¼š

- ä½ å¯ä»¥é€šè¿‡å…ƒç´ çš„ç´¢å¼•è·å–å…ƒç´ ï¼Œä¾‹å¦‚ `arr[0]`
- æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…è®¸è´Ÿç´¢å¼•çš„ `at(i)` æ–¹æ³•ã€‚å¯¹äºè´Ÿå€¼çš„ `i`ï¼Œå®ƒä¼šä»æ•°ç»„çš„æœ«å°¾å¾€å›æ•°ã€‚å¦‚æœ `i >= 0`ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ä¸ `arr[i]` ç›¸åŒã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹åˆ—æ“ä½œä»¥åŒç«¯é˜Ÿåˆ—çš„æ–¹å¼ä½¿ç”¨æ•°ç»„ï¼š

- `push(...items)` åœ¨æœ«ç«¯æ·»åŠ  `items` é¡¹ã€‚
- `pop()` ä»æœ«ç«¯ç§»é™¤å¹¶è¿”å›è¯¥å…ƒç´ ã€‚
- `shift()` ä»é¦–ç«¯ç§»é™¤å¹¶è¿”å›è¯¥å…ƒç´ ã€‚
- `unshift(...items)` ä»é¦–ç«¯æ·»åŠ  `items` é¡¹ã€‚

éå†æ•°ç»„çš„å…ƒç´ ï¼š

- `for (let i=0; i<arr.length; i++)` â€” è¿è¡Œå¾—æœ€å¿«ï¼Œå¯å…¼å®¹æ—§ç‰ˆæœ¬æµè§ˆå™¨ã€‚
- `for (let item of arr)` â€” ç°ä»£è¯­æ³•ï¼Œåªèƒ½è®¿é—® itemsã€‚
- `for (let i in arr)` â€” æ°¸è¿œä¸è¦ç”¨è¿™ä¸ªã€‚

æ•°ç»„æœ‰è‡ªå·±çš„ `toString` æ–¹æ³•çš„å®ç°ï¼Œä¼šè¿”å›ä»¥é€—å·éš”å¼€çš„å…ƒç´ åˆ—è¡¨ã€‚æ•°ç»„æ²¡æœ‰ `Symbol.toPrimitive`ï¼Œä¹Ÿæ²¡æœ‰ `valueOf`ï¼Œå®ƒä»¬åªèƒ½æ‰§è¡Œ `toString` è¿›è¡Œè½¬æ¢ï¼Œæ‰€ä»¥è¿™é‡Œ `[]` å°±å˜æˆäº†ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œ`[1]` å˜æˆäº† `"1"`ï¼Œ`[1,2]` å˜æˆäº† `"1,2"`ã€‚å½“ `"+"` è¿ç®—ç¬¦æŠŠä¸€äº›é¡¹åŠ åˆ°å­—ç¬¦ä¸²åé¢æ—¶ï¼ŒåŠ å·åé¢çš„é¡¹ä¹Ÿä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

ä¾‹å¦‚ï¼šæ¯”è¾ƒæ•°ç»„æ—¶ï¼Œä¸è¦ä½¿ç”¨ `==` è¿ç®—ç¬¦ï¼ˆå½“ç„¶ä¹Ÿä¸è¦ä½¿ç”¨ `>` å’Œ `<` ç­‰è¿ç®—ç¬¦ï¼‰ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šå¯¹æ•°ç»„è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚å®ƒä»¬é€šå¸¸ä¼šåƒå¤„ç†ä»»æ„å¯¹è±¡é‚£æ ·å¤„ç†æ•°ç»„ï¼Œè¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `for..of` å¾ªç¯æ¥é€é¡¹æ¯”è¾ƒæ•°ç»„ã€‚

## æ•°ç»„æ–¹æ³•

åœ¨è¿™é‡Œå’Œå…¶ä»–æ•°ç»„æ–¹æ³•ä¸­ï¼Œè´Ÿå‘ç´¢å¼•éƒ½æ˜¯è¢«å…è®¸çš„ã€‚

- æ·»åŠ /åˆ é™¤å…ƒç´ ï¼š
  - `push(...items)` â€”â€” å‘å°¾ç«¯æ·»åŠ å…ƒç´ ï¼Œ
  - `pop()` â€”â€” ä»å°¾ç«¯æå–ä¸€ä¸ªå…ƒç´ ï¼Œ
  - `shift()` â€”â€” ä»é¦–ç«¯æå–ä¸€ä¸ªå…ƒç´ ï¼Œ
  - `unshift(...items)` â€”â€” å‘é¦–ç«¯æ·»åŠ å…ƒç´ ï¼Œ
  - `splice(pos, deleteCount, ...items)` â€”â€” ä» `pos` å¼€å§‹åˆ é™¤ `deleteCount` ä¸ªå…ƒç´ ï¼Œå¹¶æ’å…¥ `items`ã€‚
  - `slice(start, end)` â€”â€” åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå°†ä»ç´¢å¼• `start` åˆ°ç´¢å¼• `end`ï¼ˆä½†ä¸åŒ…æ‹¬ `end`ï¼‰çš„å…ƒç´ å¤åˆ¶è¿›å»ã€‚
  - `concat(...items)` â€”â€” è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼šå¤åˆ¶å½“å‰æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ  `items`ã€‚å¦‚æœ `items` ä¸­çš„ä»»æ„ä¸€é¡¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå°±å–å…¶å…ƒç´ ã€‚
- æœç´¢å…ƒç´ ï¼š
  - `indexOf/lastIndexOf(item, pos)` â€”â€” ä»ç´¢å¼• `pos` å¼€å§‹æœç´¢ `item`ï¼Œæœç´¢åˆ°åˆ™è¿”å›è¯¥é¡¹çš„ç´¢å¼•ï¼Œå¦åˆ™è¿”å› `-1`ã€‚
  - `includes(value)` â€”â€” å¦‚æœæ•°ç»„æœ‰ `value`ï¼Œåˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
  - `find/filter(func)` â€”â€” é€šè¿‡ `func` è¿‡æ»¤å…ƒç´ ï¼Œè¿”å›ä½¿ `func` è¿”å› `true` çš„ç¬¬ä¸€ä¸ªå€¼/æ‰€æœ‰å€¼ã€‚
  - `findIndex` å’Œ `find` ç±»ä¼¼ï¼Œä½†è¿”å›ç´¢å¼•è€Œä¸æ˜¯å€¼ã€‚
- éå†å…ƒç´ ï¼š
  - `forEach(func)` â€”â€” å¯¹æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ `func`ï¼Œä¸è¿”å›ä»»ä½•å†…å®¹ã€‚
- è½¬æ¢æ•°ç»„ï¼š
  - `map(func)` â€”â€” æ ¹æ®å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ `func` çš„ç»“æœåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚
  - `sort(func)` â€”â€” å¯¹æ•°ç»„è¿›è¡ŒåŸä½ï¼ˆin-placeï¼‰æ’åºï¼Œç„¶åè¿”å›å®ƒã€‚
  - `reverse()` â€”â€” åŸä½ï¼ˆin-placeï¼‰åè½¬æ•°ç»„ï¼Œç„¶åè¿”å›å®ƒã€‚
  - `split/join` â€”â€” å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºæ•°ç»„å¹¶è¿”å›/å°†æ•°ç»„é¡¹ç»„åˆæˆå­—ç¬¦ä¸²å¹¶è¿”å›ã€‚
  - `reduce/reduceRight(func, initial)` â€”â€” é€šè¿‡å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ `func` è®¡ç®—æ•°ç»„ä¸Šçš„å•ä¸ªå€¼ï¼Œå¹¶åœ¨è°ƒç”¨ä¹‹é—´ä¼ é€’ä¸­é—´ç»“æœã€‚
- å…¶ä»–ï¼š
  - `Array.isArray(value)` æ£€æŸ¥ `value` æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

è¯·æ³¨æ„ï¼Œ`sort`ï¼Œ`reverse` å’Œ `splice` æ–¹æ³•ä¿®æ”¹çš„æ˜¯æ•°ç»„æœ¬èº«ã€‚

è¿™äº›æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œå®ƒä»¬è¦†ç›– 99ï¼… çš„ç”¨ä¾‹ã€‚ä½†æ˜¯è¿˜æœ‰å…¶ä»–å‡ ä¸ªï¼š

- `arr.some(fn)/arr.every(fn)`æ£€æŸ¥æ•°ç»„ã€‚

  ä¸ `map` ç±»ä¼¼ï¼Œå¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨å‡½æ•° `fn`ã€‚å¦‚æœä»»ä½•/æ‰€æœ‰ç»“æœä¸º `true`ï¼Œåˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

  è¿™ä¸¤ä¸ªæ–¹æ³•çš„è¡Œä¸ºç±»ä¼¼äº `||` å’Œ `&&` è¿ç®—ç¬¦ï¼šå¦‚æœ `fn` è¿”å›ä¸€ä¸ªçœŸå€¼ï¼Œ`arr.some()` ç«‹å³è¿”å› `true` å¹¶åœæ­¢è¿­ä»£å…¶ä½™æ•°ç»„é¡¹ï¼›å¦‚æœ `fn` è¿”å›ä¸€ä¸ªå‡å€¼ï¼Œ`arr.every()` ç«‹å³è¿”å› `false` å¹¶åœæ­¢å¯¹å…¶ä½™æ•°ç»„é¡¹çš„è¿­ä»£ã€‚

  æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `every` æ¥æ¯”è¾ƒæ•°ç»„ï¼š

  ```javascript
  function arraysEqual(arr1, arr2) {
    return arr1.length === arr2.length && arr1.every((value, index) => value === arr2[index]);
  }
  
  alert( arraysEqual([1, 2], [1, 2])); // true
  ```

- `arr.fill(value, start, end)` â€”â€” ä»ç´¢å¼• `start` åˆ° `end`ï¼Œç”¨é‡å¤çš„ `value` å¡«å……æ•°ç»„ã€‚

- `arr.copyWithin(target, start, end)`â€”â€” å°†ä»ä½ç½® `start` åˆ° `end` çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ° **è‡ªèº«** çš„ `target` ä½ç½®ï¼ˆè¦†ç›–ç°æœ‰å…ƒç´ ï¼‰ã€‚

- `arr.flat(depth)/[arr.flatMap(fn)`ä»å¤šç»´æ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰å¹³æ•°ç»„ã€‚

- `Array.of(element0[, element1[, â€¦[, elementN\]]])Â·`åŸºäºå¯å˜æ•°é‡çš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ `Array` å®ä¾‹ï¼Œè€Œä¸éœ€è¦è€ƒè™‘å‚æ•°çš„æ•°é‡æˆ–ç±»å‹ã€‚

æœ‰å…³å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… [æ‰‹å†Œ](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array)ã€‚

åˆ›å»ºå¯æ‰©å±•calculatorï¼š

```
function Calculator() {

  this.methods = {
    "-": (a, b) => a - b,
    "+": (a, b) => a + b
  };

  this.calculate = function(str) {

    let split = str.split(' '),
      a = +split[0],
      op = split[1],
      b = +split[2];

    if (!this.methods[op] || isNaN(a) || isNaN(b)) {
      return NaN;
    }

    return this.methods[op](a, b);
  };

  this.addMethod = function(name, func) {
    this.methods[name] = func;
  };
}
```

ä»æ•°ç»„åˆ›å»ºé”®å€¼å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªä»»åŠ¡é‡Œæˆ‘ä»¬å‡è®¾ `id` æ˜¯å”¯ä¸€çš„ã€‚æ²¡æœ‰ä¸¤ä¸ªå…·æœ‰ç›¸åŒ `id` çš„æ•°ç»„é¡¹ã€‚

```
function groupById(array) {
  return array.reduce((obj, value) => {
    obj[value.id] = value;
    return obj;
  }, {})
}
```

# å¯è¿­ä»£å¯¹è±¡

ä¸ºäº†è®©å¯¹è±¡å¯è¿­ä»£ï¼ˆä¹Ÿå°±è®© `for..of` å¯ä»¥è¿è¡Œï¼‰æˆ‘ä»¬éœ€è¦ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªåä¸º `Symbol.iterator` çš„æ–¹æ³•ï¼ˆä¸€ä¸ªä¸“é—¨ç”¨äºä½¿å¯¹è±¡å¯è¿­ä»£çš„å†…å»º symbolï¼‰ã€‚

1. å½“ `for..of` å¾ªç¯å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±ä¼šæŠ¥é”™ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª **è¿­ä»£å™¨ï¼ˆiteratorï¼‰** â€”â€” ä¸€ä¸ªæœ‰ `next` æ–¹æ³•çš„å¯¹è±¡ã€‚
2. ä»æ­¤å¼€å§‹ï¼Œ`for..of` **ä»…é€‚ç”¨äºè¿™ä¸ªè¢«è¿”å›çš„å¯¹è±¡**ã€‚
3. å½“ `for..of` å¾ªç¯å¸Œæœ›å–å¾—ä¸‹ä¸€ä¸ªæ•°å€¼ï¼Œå®ƒå°±è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ `next()` æ–¹æ³•ã€‚
4. `next()` æ–¹æ³•è¿”å›çš„ç»“æœçš„æ ¼å¼å¿…é¡»æ˜¯ `{done: Boolean, value: any}`ï¼Œå½“ `done=true` æ—¶ï¼Œè¡¨ç¤ºå¾ªç¯ç»“æŸï¼Œå¦åˆ™ `value` æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚

```javascript
let range = {
  from: 1,
  to: 5
};

// 1. for..of è°ƒç”¨é¦–å…ˆä¼šè°ƒç”¨è¿™ä¸ªï¼š
range[Symbol.iterator] = function() {

  // â€¦â€¦å®ƒè¿”å›è¿­ä»£å™¨å¯¹è±¡ï¼ˆiterator objectï¼‰ï¼š
  // 2. æ¥ä¸‹æ¥ï¼Œfor..of ä»…ä¸ä¸‹é¢çš„è¿­ä»£å™¨å¯¹è±¡ä¸€èµ·å·¥ä½œï¼Œè¦æ±‚å®ƒæä¾›ä¸‹ä¸€ä¸ªå€¼
  return {
    current: this.from,
    last: this.to,

    // 3. next() åœ¨ for..of çš„æ¯ä¸€è½®å¾ªç¯è¿­ä»£ä¸­è¢«è°ƒç”¨
    next() {
      // 4. å®ƒå°†ä¼šè¿”å› {done:.., value :...} æ ¼å¼çš„å¯¹è±¡
      if (this.current <= this.last) {
        return { done: false, value: this.current++ };
      } else {
        return { done: true };
      }
    }
  };
};

for (let num of range) {
  alert(num); // 1, ç„¶åæ˜¯ 2, 3, 4, 5
}
```

è¯·æ³¨æ„å¯è¿­ä»£å¯¹è±¡çš„æ ¸å¿ƒåŠŸèƒ½ï¼šå…³æ³¨ç‚¹åˆ†ç¦»ã€‚

- `range` è‡ªèº«æ²¡æœ‰ `next()` æ–¹æ³•ã€‚
- ç›¸åï¼Œæ˜¯é€šè¿‡è°ƒç”¨ `range[Symbol.iterator]()` åˆ›å»ºäº†å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå³æ‰€è°“çš„â€œè¿­ä»£å™¨â€å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒçš„ `next` ä¼šä¸ºè¿­ä»£ç”Ÿæˆå€¼ã€‚

å› æ­¤ï¼Œè¿­ä»£å™¨å¯¹è±¡å’Œä¸å…¶è¿›è¡Œè¿­ä»£çš„å¯¹è±¡æ˜¯åˆ†å¼€çš„ã€‚ä»æŠ€æœ¯ä¸Šè¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åˆå¹¶ï¼Œå¹¶ä½¿ç”¨ `range` è‡ªèº«ä½œä¸ºè¿­ä»£å™¨æ¥ç®€åŒ–ä»£ç ã€‚ä½†ç¼ºç‚¹æ˜¯ï¼Œç°åœ¨ä¸å¯èƒ½åŒæ—¶åœ¨å¯¹è±¡ä¸Šè¿è¡Œä¸¤ä¸ª `for..of` å¾ªç¯äº†ï¼šå®ƒä»¬å°†å…±äº«è¿­ä»£çŠ¶æ€ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå³å¯¹è±¡æœ¬èº«ã€‚ä½†æ˜¯ä¸¤ä¸ªå¹¶è¡Œçš„ `for..of` æ˜¯å¾ˆç½•è§çš„ï¼Œå³ä½¿åœ¨å¼‚æ­¥æƒ…å†µä¸‹ã€‚

```javascript
let range = {
  from: 1,
  to: 5,

  [Symbol.iterator]() {
    this.current = this.from;
    return this;
  },

  next() {
    if (this.current <= this.to) {
      return { done: false, value: this.current++ };
    } else {
      return { done: true };
    }
  }
};

for (let num of range) {
  alert(num); // 1, ç„¶åæ˜¯ 2, 3, 4, 5
}
```

- **Iterable** å¦‚ä¸Šæ‰€è¿°ï¼Œæ˜¯å®ç°äº† `Symbol.iterator` æ–¹æ³•çš„å¯¹è±¡ã€‚
- **Array-like** æ˜¯æœ‰ç´¢å¼•å’Œ `length` å±æ€§çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒä»¬çœ‹èµ·æ¥å¾ˆåƒæ•°ç»„ã€‚

å¯ä»¥åº”ç”¨ `for..of` çš„å¯¹è±¡è¢«ç§°ä¸º **å¯è¿­ä»£çš„**ã€‚

- æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå¯è¿­ä»£å¯¹è±¡å¿…é¡»å®ç°`Symbol.iterator`æ–¹æ³•ã€‚
  - `obj[Symbol.iterator]()` çš„ç»“æœè¢«ç§°ä¸º **è¿­ä»£å™¨ï¼ˆiteratorï¼‰**ã€‚ç”±å®ƒå¤„ç†è¿›ä¸€æ­¥çš„è¿­ä»£è¿‡ç¨‹ã€‚
  - ä¸€ä¸ªè¿­ä»£å™¨å¿…é¡»æœ‰ `next()` æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª `{done: Boolean, value: any}` å¯¹è±¡ï¼Œè¿™é‡Œ `done:true` è¡¨æ˜è¿­ä»£ç»“æŸï¼Œå¦åˆ™ `value` å°±æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚
- `Symbol.iterator` æ–¹æ³•ä¼šè¢« `for..of` è‡ªåŠ¨è°ƒç”¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒã€‚
- å†…å»ºçš„å¯è¿­ä»£å¯¹è±¡ä¾‹å¦‚å­—ç¬¦ä¸²å’Œæ•°ç»„ï¼Œéƒ½å®ç°äº† `Symbol.iterator`ã€‚
- å­—ç¬¦ä¸²è¿­ä»£å™¨èƒ½å¤Ÿè¯†åˆ«ä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰ã€‚ï¼ˆè¯‘æ³¨ï¼šä»£ç†å¯¹ä¹Ÿå°±æ˜¯ UTF-16 æ‰©å±•å­—ç¬¦ã€‚ï¼‰

æœ‰ç´¢å¼•å±æ€§å’Œ `length` å±æ€§çš„å¯¹è±¡è¢«ç§°ä¸º **ç±»æ•°ç»„å¯¹è±¡**ã€‚è¿™ç§å¯¹è±¡å¯èƒ½è¿˜å…·æœ‰å…¶ä»–å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰æ•°ç»„çš„å†…å»ºæ–¹æ³•ã€‚

å¦‚æœæˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹è§„èŒƒ â€”â€” å°±ä¼šå‘ç°å¤§å¤šæ•°å†…å»ºæ–¹æ³•éƒ½å‡è®¾å®ƒä»¬éœ€è¦å¤„ç†çš„æ˜¯å¯è¿­ä»£å¯¹è±¡æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ï¼Œè€Œä¸æ˜¯â€œçœŸæ­£çš„â€æ•°ç»„ï¼Œå› ä¸ºè¿™æ ·æŠ½è±¡åº¦æ›´é«˜ã€‚

`Array.from(obj[, mapFn, thisArg])` å°†å¯è¿­ä»£å¯¹è±¡æˆ–ç±»æ•°ç»„å¯¹è±¡ `obj` è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„ `Array`ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹å®ƒåº”ç”¨æ•°ç»„çš„æ–¹æ³•ã€‚å¯é€‰å‚æ•° `mapFn` å’Œ `thisArg` å…è®¸æˆ‘ä»¬å°†å‡½æ•°åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ã€‚

```javascript
let range = {
  from: 1,
  to: 5
};

let arr = Array.from(range, num => num * num);

alert(arr); // 1,4,9,16,25
```

# Map

[Map](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Map) æ˜¯ä¸€ä¸ªå¸¦é”®çš„æ•°æ®é¡¹çš„é›†åˆï¼Œå°±åƒä¸€ä¸ª `Object` ä¸€æ ·ã€‚ ä½†æ˜¯å®ƒä»¬æœ€å¤§çš„å·®åˆ«æ˜¯ `Map` å…è®¸ä»»ä½•ç±»å‹çš„é”®ï¼ˆkeyï¼‰ã€‚

å®ƒçš„æ–¹æ³•å’Œå±æ€§å¦‚ä¸‹ï¼š

- `new Map()` â€”â€” åˆ›å»º mapã€‚
- `map.set(key, value)` â€”â€” æ ¹æ®é”®å­˜å‚¨å€¼ã€‚
- `map.get(key)` â€”â€” æ ¹æ®é”®æ¥è¿”å›å€¼ï¼Œå¦‚æœ `map` ä¸­ä¸å­˜åœ¨å¯¹åº”çš„ `key`ï¼Œåˆ™è¿”å› `undefined`ã€‚
- `map.has(key)` â€”â€” å¦‚æœ `key` å­˜åœ¨åˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `map.delete(key)` â€”â€” åˆ é™¤æŒ‡å®šé”®çš„å€¼ã€‚
- `map.clear()` â€”â€” æ¸…ç©º mapã€‚
- `map.size` â€”â€” è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚

> **`map[key]` ä¸æ˜¯ä½¿ç”¨ `Map` çš„æ­£ç¡®æ–¹å¼**
>
> è™½ç„¶ `map[key]` ä¹Ÿæœ‰æ•ˆï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥è®¾ç½® `map[key] = 2`ï¼Œè¿™æ ·ä¼šå°† `map` è§†ä¸º JavaScript çš„ plain objectï¼Œå› æ­¤å®ƒæš—å«äº†æ‰€æœ‰ç›¸åº”çš„é™åˆ¶ï¼ˆä»…æ”¯æŒ string/symbol é”®ç­‰ï¼‰ã€‚
>
> æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ `map` æ–¹æ³•ï¼š`set` å’Œ `get` ç­‰ã€‚

æ¯ä¸€æ¬¡ `map.set` è°ƒç”¨éƒ½ä¼šè¿”å› map æœ¬èº«ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œâ€œé“¾å¼â€è°ƒç”¨ï¼š

```javascript
map.set('1', 'str1')
  .set(1, 'num1')
  .set(true, 'bool1');
```

å¦‚æœè¦åœ¨ `map` é‡Œä½¿ç”¨å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š

- `map.keys()` â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é”®çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ
- `map.values()` â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å€¼çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ
- `map.entries()` â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å®ä½“ `[key, value]` çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ`for..of` åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œ`Map` æœ‰å†…å»ºçš„ `forEach` æ–¹æ³•ï¼Œä¸ `Array` ç±»ä¼¼ã€‚

```javascript
let recipeMap = new Map([
  ['cucumber', 500],
  ['tomatoes', 350],
  ['onion',    50]
]);

// éå†æ‰€æœ‰çš„é”®ï¼ˆvegetablesï¼‰
for (let vegetable of recipeMap.keys()) {
  alert(vegetable); // cucumber, tomatoes, onion
}

// éå†æ‰€æœ‰çš„å€¼ï¼ˆamountsï¼‰
for (let amount of recipeMap.values()) {
  alert(amount); // 500, 350, 50
}

// éå†æ‰€æœ‰çš„å®ä½“ [key, value]
for (let entry of recipeMap) { // ä¸ recipeMap.entries() ç›¸åŒ
  alert(entry); // cucumber,500 (and so on)
}

// å¯¹æ¯ä¸ªé”®å€¼å¯¹ (key, value) è¿è¡Œ forEach å‡½æ•°
recipeMap.forEach( (value, key, map) => {
  alert(`${key}: ${value}`); // cucumber: 500 etc
});
```

## Object & Map

å½“åˆ›å»ºä¸€ä¸ª `Map` åï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¸¦æœ‰é”®å€¼å¯¹çš„æ•°ç»„ï¼ˆæˆ–å…¶å®ƒå¯è¿­ä»£å¯¹è±¡ï¼‰æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
// é”®å€¼å¯¹ [key, value] æ•°ç»„
let map = new Map([
  ['1',  'str1'],
  [1,    'num1'],
  [true, 'bool1']
]);

alert( map.get('1') ); // str1
```

å¦‚æœæˆ‘ä»¬æƒ³ä»ä¸€ä¸ªå·²æœ‰çš„æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰æ¥åˆ›å»ºä¸€ä¸ª `Map`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…å»ºæ–¹æ³• [Object.entries(obj)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)ï¼Œè¯¥æ–¹æ³•è¿”å›å¯¹è±¡çš„é”®/å€¼å¯¹æ•°ç»„ï¼Œè¯¥æ•°ç»„æ ¼å¼å®Œå…¨æŒ‰ç…§ `Map` æ‰€éœ€çš„æ ¼å¼ã€‚

æ‰€ä»¥å¯ä»¥åƒä¸‹é¢è¿™æ ·ä»ä¸€ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ª Mapï¼š

```javascript
let obj = {
  name: "John",
  age: 30
};

let map = new Map(Object.entries(obj));

alert( map.get('name') ); // John
```

è¿™é‡Œï¼Œ`Object.entries` è¿”å›é”®/å€¼å¯¹æ•°ç»„ï¼š`[ ["name","John"], ["age", 30] ]`ã€‚è¿™å°±æ˜¯ `Map` æ‰€éœ€è¦çš„æ ¼å¼ã€‚

`Object.fromEntries` æ–¹æ³•çš„ä½œç”¨æ˜¯ç›¸åçš„ï¼šç»™å®šä¸€ä¸ªå…·æœ‰ `[key, value]` é”®å€¼å¯¹çš„æ•°ç»„ï¼Œå®ƒä¼šæ ¹æ®ç»™å®šæ•°ç»„åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼š

```javascript
let prices = Object.fromEntries([
  ['banana', 1],
  ['orange', 2],
  ['meat', 4]
]);

// ç°åœ¨ prices = { banana: 1, orange: 2, meat: 4 }

alert(prices.orange); // 2
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Object.fromEntries` ä» `Map` å¾—åˆ°ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ `Map` ä¸­å­˜å‚¨äº†ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŠŠè¿™äº›æ•°æ®ä¼ ç»™éœ€è¦æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰çš„ç¬¬ä¸‰æ–¹ä»£ç ã€‚

```javascript
let map = new Map();
map.set('banana', 1);
map.set('orange', 2);
map.set('meat', 4);

let obj = Object.fromEntries(map.entries()); // åˆ›å»ºä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰(*)

// å®Œæˆäº†ï¼
// obj = { banana: 1, orange: 2, meat: 4 }

alert(obj.orange); // 2
```

è°ƒç”¨ `map.entries()` å°†è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„é”®/å€¼å¯¹ï¼Œè¿™åˆšå¥½æ˜¯ `Object.fromEntries` æ‰€éœ€è¦çš„æ ¼å¼ã€‚

æˆ‘ä»¬å¯ä»¥æŠŠå¸¦ `(*)` è¿™ä¸€è¡Œå†™å¾—æ›´çŸ­ï¼š

```javascript
let obj = Object.fromEntries(map); // çœæ‰ .entries()
```

ä¸Šé¢çš„ä»£ç ä½œç”¨ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸º `Object.fromEntries` æœŸæœ›å¾—åˆ°ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè€Œä¸ä¸€å®šæ˜¯æ•°ç»„ã€‚å¹¶ä¸” `map` çš„æ ‡å‡†è¿­ä»£ä¼šè¿”å›è·Ÿ `map.entries()` ä¸€æ ·çš„é”®/å€¼å¯¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰ï¼Œå…¶é”®/å€¼å¯¹ä¸ `map` ç›¸åŒã€‚

# Set

`Set` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹é›†åˆ â€”â€” â€œå€¼çš„é›†åˆâ€ï¼ˆæ²¡æœ‰é”®ï¼‰ï¼Œå®ƒçš„æ¯ä¸€ä¸ªå€¼åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚

å®ƒçš„ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

- `new Set(iterable)` â€”â€” åˆ›å»ºä¸€ä¸ª `set`ï¼Œå¦‚æœæä¾›äº†ä¸€ä¸ª `iterable` å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯æ•°ç»„ï¼‰ï¼Œå°†ä¼šä»æ•°ç»„é‡Œé¢å¤åˆ¶å€¼åˆ° `set` ä¸­ã€‚
- `set.add(value)` â€”â€” æ·»åŠ ä¸€ä¸ªå€¼ï¼Œè¿”å› set æœ¬èº«
- `set.delete(value)` â€”â€” åˆ é™¤å€¼ï¼Œå¦‚æœ `value` åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ—¶å€™å­˜åœ¨åˆ™è¿”å› `true` ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `set.has(value)` â€”â€” å¦‚æœ `value` åœ¨ set ä¸­ï¼Œè¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `set.clear()` â€”â€” æ¸…ç©º setã€‚
- `set.size` â€”â€” è¿”å›å…ƒç´ ä¸ªæ•°ã€‚

å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œé‡å¤ä½¿ç”¨åŒä¸€ä¸ªå€¼è°ƒç”¨ `set.add(value)` å¹¶ä¸ä¼šå‘ç”Ÿä»€ä¹ˆæ”¹å˜ã€‚è¿™å°±æ˜¯ `Set` é‡Œé¢çš„æ¯ä¸€ä¸ªå€¼åªå‡ºç°ä¸€æ¬¡çš„åŸå› ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `for..of` æˆ– `forEach` æ¥éå† Setï¼š

```javascript
let set = new Set(["oranges", "apples", "bananas"]);

for (let value of set) alert(value);

// ä¸ forEach ç›¸åŒï¼š
set.forEach((value, valueAgain, set) => {
  alert(value);
});
```

æ³¨æ„ä¸€ä»¶æœ‰è¶£çš„äº‹å„¿ã€‚`forEach` çš„å›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ª `value`ï¼Œç„¶åæ˜¯ **åŒä¸€ä¸ªå€¼** `valueAgain`ï¼Œæœ€åæ˜¯ç›®æ ‡å¯¹è±¡ã€‚æ²¡é”™ï¼ŒåŒä¸€ä¸ªå€¼åœ¨å‚æ•°é‡Œå‡ºç°äº†ä¸¤æ¬¡ã€‚

`forEach` çš„å›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ˜¯ä¸ºäº†ä¸ `Map` å…¼å®¹ã€‚å½“ç„¶ï¼Œè¿™çœ‹èµ·æ¥ç¡®å®æœ‰äº›å¥‡æ€ªã€‚ä½†æ˜¯è¿™å¯¹åœ¨ç‰¹å®šæƒ…å†µä¸‹è½»æ¾åœ°ç”¨ `Set` ä»£æ›¿ `Map` å¾ˆæœ‰å¸®åŠ©ï¼Œåä¹‹äº¦ç„¶ã€‚

`Map` ä¸­ç”¨äºè¿­ä»£çš„æ–¹æ³•åœ¨ `Set` ä¸­ä¹ŸåŒæ ·æ”¯æŒï¼š

- `set.keys()` â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å€¼çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ
- `set.values()` â€”â€” ä¸ `set.keys()` ä½œç”¨ç›¸åŒï¼Œè¿™æ˜¯ä¸ºäº†å…¼å®¹ `Map`ï¼Œ
- `set.entries()` â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰çš„å®ä½“ `[value, value]` çš„å¯è¿­ä»£å¯¹è±¡ï¼Œå®ƒçš„å­˜åœ¨ä¹Ÿæ˜¯ä¸ºäº†å…¼å®¹ `Map`ã€‚

# å¼±æ˜ å°„å’Œå¼±é›†åˆ

å¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¸¸è§„ `Map` çš„é”®ï¼Œé‚£ä¹ˆå½“ `Map` å­˜åœ¨æ—¶ï¼Œè¯¥å¯¹è±¡ä¹Ÿå°†å­˜åœ¨ã€‚å®ƒä¼šå ç”¨å†…å­˜ï¼Œå¹¶ä¸”ä¸ä¼šè¢«ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ï¼‰å›æ”¶ã€‚

`WeakMap` å’Œ `Map` çš„ç¬¬ä¸€ä¸ªä¸åŒç‚¹å°±æ˜¯ï¼Œ`WeakMap` çš„é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯åŸå§‹å€¼ï¼š`WeakMap` ä¸æ”¯æŒè¿­ä»£ä»¥åŠ `keys()`ï¼Œ`values()` å’Œ `entries()` æ–¹æ³•ã€‚æ‰€ä»¥æ²¡æœ‰åŠæ³•è·å– `WeakMap` çš„æ‰€æœ‰é”®æˆ–å€¼ã€‚å¦‚æœæˆ‘ä»¬åœ¨ weakMap ä¸­ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–å¯¹è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ â€”â€” è¯¥å¯¹è±¡å°†ä¼šè¢«ä»å†…å­˜ï¼ˆå’Œmapï¼‰ä¸­è‡ªåŠ¨æ¸…é™¤ã€‚`WeakMap` çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ **é¢å¤–æ•°æ®çš„å­˜å‚¨**ã€‚å¦å¤–ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯ç¼“å­˜ã€‚æˆ‘ä»¬å¯ä»¥å­˜å‚¨ï¼ˆâ€œç¼“å­˜â€ï¼‰å‡½æ•°çš„ç»“æœï¼Œä»¥ä¾¿å°†æ¥å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„è°ƒç”¨å¯ä»¥é‡ç”¨è¿™ä¸ªç»“æœã€‚

`WeakMap` åªæœ‰ä»¥ä¸‹çš„æ–¹æ³•ï¼š

- `weakMap.get(key)`
- `weakMap.set(key, value)`
- `weakMap.delete(key)`
- `weakMap.has(key)`

ç¼“å­˜ï¼š

```javascript
// ğŸ“ cache.js
let cache = new WeakMap();

// è®¡ç®—å¹¶è®°ç»“æœ
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* calculate the result for */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

// ğŸ“ main.js
let obj = {/* some object */};

let result1 = process(obj);
let result2 = process(obj);

// â€¦â€¦ç¨åï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡æ—¶ï¼š
obj = null;

// æ— æ³•è·å– cache.sizeï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª WeakMapï¼Œ
// è¦ä¹ˆæ˜¯ 0ï¼Œæˆ–å³å°†å˜ä¸º 0
// å½“ obj è¢«åƒåœ¾å›æ”¶ï¼Œç¼“å­˜çš„æ•°æ®ä¹Ÿä¼šè¢«æ¸…é™¤
```

`WeakSet` çš„è¡¨ç°ç±»ä¼¼ï¼š

- ä¸ `Set` ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½å‘ `WeakSet` æ·»åŠ å¯¹è±¡ï¼ˆè€Œä¸èƒ½æ˜¯åŸå§‹å€¼ï¼‰ã€‚
- å¯¹è±¡åªæœ‰åœ¨å…¶å®ƒæŸä¸ªï¼ˆäº›ï¼‰åœ°æ–¹èƒ½è¢«è®¿é—®çš„æ—¶å€™ï¼Œæ‰èƒ½ç•™åœ¨ `WeakSet` ä¸­ã€‚
- è·Ÿ `Set` ä¸€æ ·ï¼Œ`WeakSet` æ”¯æŒ `add`ï¼Œ`has` å’Œ `delete` æ–¹æ³•ï¼Œä½†ä¸æ”¯æŒ `size` å’Œ `keys()`ï¼Œå¹¶ä¸”ä¸å¯è¿­ä»£ã€‚

`WeakMap` æ˜¯ç±»ä¼¼äº `Map` çš„é›†åˆï¼Œå®ƒä»…å…è®¸å¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®è¿™äº›å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶ä¾¿ä¼šå°†è¿™äº›å¯¹è±¡ä¸å…¶å…³è”å€¼ä¸€åŒåˆ é™¤ã€‚

`WeakSet` æ˜¯ç±»ä¼¼äº `Set` çš„é›†åˆï¼Œå®ƒä»…å­˜å‚¨å¯¹è±¡ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®è¿™äº›å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶ä¾¿ä¼šå°†è¿™äº›å¯¹è±¡åˆ é™¤ã€‚

å®ƒä»¬çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å®ƒä»¬å¯¹å¯¹è±¡æ˜¯å¼±å¼•ç”¨ï¼Œæ‰€ä»¥è¢«å®ƒä»¬å¼•ç”¨çš„å¯¹è±¡å¾ˆå®¹æ˜“åœ°è¢«åƒåœ¾æ”¶é›†å™¨ç§»é™¤ã€‚

è¿™æ˜¯ä»¥ä¸æ”¯æŒ `clear`ã€`size`ã€`keys`ã€`values` ç­‰ä½œä¸ºä»£ä»·æ¢æ¥çš„ã€‚`WeakMap` å’Œ `WeakSet` æœ€æ˜æ˜¾çš„å±€é™æ€§å°±æ˜¯ä¸èƒ½è¿­ä»£ï¼Œå¹¶ä¸”æ— æ³•è·å–æ‰€æœ‰å½“å‰å†…å®¹ã€‚é‚£æ ·å¯èƒ½ä¼šé€ æˆä¸ä¾¿ï¼Œä½†æ˜¯å¹¶ä¸ä¼šé˜»æ­¢ `WeakMap/WeakSet` å®Œæˆå…¶ä¸»è¦å·¥ä½œ â€”â€” ä¸ºåœ¨å…¶å®ƒåœ°æ–¹å­˜å‚¨/ç®¡ç†çš„å¯¹è±¡æ•°æ®æä¾›â€œé¢å¤–â€å­˜å‚¨ã€‚

`WeakMap` å’Œ `WeakSet` è¢«ç”¨ä½œâ€œä¸»è¦â€å¯¹è±¡å­˜å‚¨ä¹‹å¤–çš„â€œè¾…åŠ©â€æ•°æ®ç»“æ„ã€‚ä¸€æ—¦å°†å¯¹è±¡ä»ä¸»å­˜å‚¨å™¨ä¸­åˆ é™¤ï¼Œå¦‚æœè¯¥å¯¹è±¡ä»…è¢«ç”¨ä½œ `WeakMap` æˆ– `WeakSet` çš„é”®ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å°†è¢«è‡ªåŠ¨æ¸…é™¤ã€‚

# `Object.keys, values, entries`

è¿™äº›æ–¹æ³•æ˜¯é€šç”¨çš„ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„çº¦å®šæ¥å°†å®ƒä»¬ç”¨äºå„ç§æ•°æ®ç»“æ„ã€‚å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å®ç°è¿™äº›æ–¹æ³•ã€‚

å®ƒä»¬æ”¯æŒï¼š

- `Map`
- `Set`
- `Array`

å¯¹äºæ™®é€šå¯¹è±¡ï¼Œä¸‹åˆ—è¿™äº›æ–¹æ³•æ˜¯å¯ç”¨çš„ï¼š

- `Object.keys(obj)`â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„é”®çš„æ•°ç»„ã€‚
- `Object.values(obj)` â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„å€¼çš„æ•°ç»„ã€‚
- `Object.entries(obj)` â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰ [key, value] é”®å€¼å¯¹çš„æ•°ç»„ã€‚

ä½†æ˜¯è¯·æ³¨æ„åŒºåˆ«ã€‚ç¬¬ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå¯¹äºå¯¹è±¡æˆ‘ä»¬ä½¿ç”¨çš„è°ƒç”¨è¯­æ³•æ˜¯ `Object.keys(obj)`ï¼Œè€Œä¸æ˜¯ `obj.keys()`ã€‚

ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿä¸»è¦åŸå› æ˜¯çµæ´»æ€§ã€‚è¯·è®°ä½ï¼Œåœ¨ JavaScript ä¸­ï¼Œå¯¹è±¡æ˜¯æ‰€æœ‰å¤æ‚ç»“æ„çš„åŸºç¡€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªè‡ªå·±åˆ›å»ºçš„å¯¹è±¡ï¼Œæ¯”å¦‚ `data`ï¼Œå¹¶å®ç°äº†å®ƒè‡ªå·±çš„ `data.values()` æ–¹æ³•ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥å¯¹å®ƒè°ƒç”¨ `Object.values(data)` æ–¹æ³•ã€‚

ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ `Object.*` æ–¹æ³•è¿”å›çš„æ˜¯â€œçœŸæ­£çš„â€æ•°ç»„å¯¹è±¡ï¼Œè€Œä¸åªæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚è¿™ä¸»è¦æ˜¯å†å²åŸå› ã€‚

## è½¬æ¢å¯¹è±¡

å¯¹è±¡ç¼ºå°‘æ•°ç»„å­˜åœ¨çš„è®¸å¤šæ–¹æ³•ï¼Œä¾‹å¦‚ `map` å’Œ `filter` ç­‰ã€‚

å¦‚æœæˆ‘ä»¬æƒ³åº”ç”¨å®ƒä»¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Object.entries`ï¼Œç„¶åä½¿ç”¨ `Object.fromEntries`ï¼š

1. ä½¿ç”¨ `Object.entries(obj)` ä» `obj` è·å–ç”±é”®/å€¼å¯¹ç»„æˆçš„æ•°ç»„ã€‚
2. å¯¹è¯¥æ•°ç»„ä½¿ç”¨æ•°ç»„æ–¹æ³•ï¼Œä¾‹å¦‚ `map`ï¼Œå¯¹è¿™äº›é”®/å€¼å¯¹è¿›è¡Œè½¬æ¢ã€‚
3. å¯¹ç»“æœæ•°ç»„ä½¿ç”¨ `Object.fromEntries(array)` æ–¹æ³•ï¼Œå°†ç»“æœè½¬å›æˆå¯¹è±¡ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¸¦æœ‰ä»·æ ¼çš„å¯¹è±¡ï¼Œå¹¶æƒ³å°†å®ƒä»¬åŠ å€ï¼š

```javascript
let prices = {
  banana: 1,
  orange: 2,
  meat: 4,
};

let doublePrices = Object.fromEntries(
  // å°†ä»·æ ¼è½¬æ¢ä¸ºæ•°ç»„ï¼Œå°†æ¯ä¸ªé”®/å€¼å¯¹æ˜ å°„ä¸ºå¦ä¸€å¯¹
  // ç„¶åé€šè¿‡ fromEntries å†å°†ç»“æœè½¬æ¢ä¸ºå¯¹è±¡
  Object.entries(prices).map(entry => [entry[0], entry[1] * 2])
);

alert(doublePrices.meat); // 8
```

# è§£æ„èµ‹å€¼

**è§£æ„èµ‹å€¼** æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ï¼Œå®ƒä½¿æˆ‘ä»¬å¯ä»¥å°†æ•°ç»„æˆ–å¯¹è±¡â€œæ‹†åŒ…â€è‡³ä¸€ç³»åˆ—å˜é‡ä¸­ã€‚æœ‰æ—¶è¿™æ ·åšæ›´æ–¹ä¾¿ã€‚

## æ•°ç»„è§£æ„

```javascript
// æˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æ”¾äº†åå­—å’Œå§“æ°çš„æ•°ç»„
let arr = ["John", "Smith"]

// è§£æ„èµ‹å€¼
// è®¾ç½® firstName = arr[0]
// ä»¥åŠ surname = arr[1]
let [firstName, surname] = arr;

alert(firstName); // John
alert(surname);  // Smith
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å˜é‡è€ŒéåŸæ¥çš„æ•°ç»„é¡¹äº†ã€‚è¿™ç§è¯­æ³•è¢«å«åšâ€œè§£æ„èµ‹å€¼â€ï¼Œæ˜¯å› ä¸ºå®ƒâ€œæ‹†å¼€â€äº†æ•°ç»„æˆ–å¯¹è±¡ï¼Œå°†å…¶ä¸­çš„å„å…ƒç´ å¤åˆ¶ç»™ä¸€äº›å˜é‡ã€‚åŸæ¥çš„æ•°ç»„æˆ–å¯¹è±¡è‡ªèº«æ²¡æœ‰è¢«ä¿®æ”¹ã€‚

æ¢å¥è¯è¯´ï¼Œè§£æ„èµ‹å€¼åªæ˜¯å†™èµ·æ¥ç®€æ´ä¸€ç‚¹ã€‚ä»¥ä¸‹ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ï¼š

```javascript
// let [firstName, surname] = arr;
let firstName = arr[0];
let surname = arr[1];
```

å¯ä»¥é€šè¿‡æ·»åŠ é¢å¤–çš„é€—å·æ¥ä¸¢å¼ƒæ•°ç»„ä¸­ä¸æƒ³è¦çš„å…ƒç´ ï¼š

```javascript
// ä¸éœ€è¦ç¬¬äºŒä¸ªå…ƒç´ 
let [firstName, , title] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];

alert( title ); // Consul
```

å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸ä»»ä½•å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸ä»…é™äºæ•°ç»„ï¼š

```javascript
let [a, b, c] = "abc"; // ["a", "b", "c"]
let [one, two, three] = new Set([1, 2, 3]);
```

è¿™ç§æƒ…å†µä¸‹è§£æ„èµ‹å€¼æ˜¯é€šè¿‡è¿­ä»£å³ä¾§çš„å€¼æ¥å®Œæˆå·¥ä½œçš„ã€‚è¿™æ˜¯ä¸€ç§ç”¨äºå¯¹åœ¨ `=` å³ä¾§çš„å€¼ä¸Šè°ƒç”¨ `for..of` å¹¶è¿›è¡Œèµ‹å€¼çš„æ“ä½œçš„è¯­æ³•ç³–ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ç­‰å·å·¦ä¾§ä½¿ç”¨ä»»ä½•â€œå¯ä»¥è¢«èµ‹å€¼çš„â€ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼š

```javascript
let user = {};
[user.name, user.surname] = "John Smith".split(' ');

alert(user.name); // John
alert(user.surname); // Smith
```

æˆ‘ä»¬å¯ä»¥å°† .entries() æ–¹æ³•ä¸è§£æ„è¯­æ³•ä¸€åŒä½¿ç”¨ï¼Œæ¥éå†ä¸€ä¸ªå¯¹è±¡çš„â€œé”®â€”å€¼â€å¯¹ï¼š

```javascript
let user = {
  name: "John",
  age: 30
};

// ä½¿ç”¨å¾ªç¯éå†é”®â€”å€¼å¯¹
for (let [key, value] of Object.entries(user)) {
  alert(`${key}:${value}`); // name:John, then age:30
}
```

ç”¨äº `Map` çš„ç±»ä¼¼ä»£ç æ›´ç®€å•ï¼Œå› ä¸º Map æ˜¯å¯è¿­ä»£çš„ï¼š

```javascript
let user = new Map();
user.set("name", "John");
user.set("age", "30");

// Map æ˜¯ä»¥ [key, value] å¯¹çš„å½¢å¼è¿›è¡Œè¿­ä»£çš„ï¼Œéå¸¸ä¾¿äºè§£æ„
for (let [key, value] of user) {
  alert(`${key}:${value}`); // name:John, then age:30
}
```

ä½¿ç”¨è§£æ„èµ‹å€¼æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼æ˜¯ä¸€ä¸ªè‘—åçš„æŠ€å·§ï¼š

```javascript
let guest = "Jane";
let admin = "Pete";

// è®©æˆ‘ä»¬æ¥äº¤æ¢å˜é‡çš„å€¼ï¼šä½¿å¾— guest = Peteï¼Œadmin = Jane
[guest, admin] = [admin, guest];

alert(`${guest} ${admin}`); // Pete Janeï¼ˆæˆåŠŸäº¤æ¢ï¼ï¼‰
```

è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç”±ä¸¤ä¸ªå˜é‡ç»„æˆçš„ä¸´æ—¶æ•°ç»„ï¼Œå¹¶ä¸”ç«‹å³ä»¥é¢ å€’çš„é¡ºåºå¯¹å…¶è¿›è¡Œäº†è§£æ„èµ‹å€¼ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹å¼äº¤æ¢ä¸¤ä¸ªä»¥ä¸Šçš„å˜é‡ã€‚

å¦‚æœæˆ‘ä»¬è¿˜æƒ³æ”¶é›†å…¶ä½™çš„æ•°ç»„é¡¹ â€”â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªç‚¹ `"..."` æ¥å†åŠ ä¸€ä¸ªå‚æ•°ä»¥è·å–å…¶ä½™æ•°ç»„é¡¹ï¼š

```javascript
let [name1, name2, ...rest] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];

// rest æ˜¯åŒ…å«ä»ç¬¬ä¸‰é¡¹å¼€å§‹çš„å…¶ä½™æ•°ç»„é¡¹çš„æ•°ç»„
alert(rest[0]); // Consul
alert(rest[1]); // of the Roman Republic
alert(rest.length); // 2
```

`rest` çš„å€¼å°±æ˜¯æ•°ç»„ä¸­å‰©ä¸‹çš„å…ƒç´ ç»„æˆçš„æ•°ç»„ã€‚

ä¸ä¸€å®šè¦ä½¿ç”¨å˜é‡å `rest`ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–çš„å˜é‡åã€‚åªè¦ç¡®ä¿å®ƒå‰é¢æœ‰ä¸‰ä¸ªç‚¹ï¼Œå¹¶ä¸”åœ¨è§£æ„èµ‹å€¼çš„æœ€åä¸€ä¸ªå‚æ•°ä½ç½®ä¸Šå°±è¡Œäº†ï¼š

```javascript
let [name1, name2, ...titles] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];
// ç°åœ¨ titles = ["Consul", "of the Roman Republic"]
```

å¦‚æœæ•°ç»„æ¯”å·¦è¾¹çš„å˜é‡åˆ—è¡¨çŸ­ï¼Œè¿™é‡Œä¸ä¼šå‡ºç°æŠ¥é”™ã€‚ç¼ºå°‘å¯¹åº”å€¼çš„å˜é‡éƒ½ä¼šè¢«èµ‹ `undefined`ï¼š

```javascript
let [firstName, surname] = [];

alert(firstName); // undefined
alert(surname); // undefined
```

å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªâ€œé»˜è®¤â€å€¼ç»™æœªèµ‹å€¼çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `=` æ¥æä¾›ï¼š

```javascript
// é»˜è®¤å€¼
let [name = "Guest", surname = "Anonymous"] = ["Julius"];

alert(name);    // Juliusï¼ˆæ¥è‡ªæ•°ç»„çš„å€¼ï¼‰
alert(surname); // Anonymousï¼ˆé»˜è®¤å€¼è¢«ä½¿ç”¨äº†ï¼‰
```

é»˜è®¤å€¼å¯ä»¥æ˜¯æ›´åŠ å¤æ‚çš„è¡¨è¾¾å¼ï¼Œç”šè‡³å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨ã€‚**ä¸è¿‡ï¼Œè¿™äº›è¡¨è¾¾å¼æˆ–å‡½æ•°åªä¼šåœ¨è¿™ä¸ªå˜é‡æœªè¢«èµ‹å€¼çš„æ—¶å€™æ‰ä¼šè¢«è®¡ç®—ã€‚**

## å¯¹è±¡è§£æ„

åŸºæœ¬è¯­æ³•æ˜¯ï¼š

```javascript
let {var1, var2} = {var1:â€¦, var2:â€¦}
```

åœ¨ç­‰å·å³ä¾§æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒæ‹†åˆ†åˆ°å˜é‡ä¸­ã€‚ç­‰å·å·¦ä¾§åŒ…å«äº†å¯¹è±¡ç›¸åº”å±æ€§çš„ä¸€ä¸ªç±»å¯¹è±¡â€œæ¨¡å¼ï¼ˆpatternï¼‰â€ã€‚åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œç­‰å·å·¦ä¾§çš„å°±æ˜¯ `{...}` ä¸­çš„å˜é‡ååˆ—è¡¨ã€‚

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

let {title, width, height} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
```

å±æ€§ `options.title`ã€`options.width` å’Œ `options.height` å€¼è¢«èµ‹ç»™äº†å¯¹åº”çš„å˜é‡ã€‚

å˜é‡çš„é¡ºåºå¹¶ä¸é‡è¦ï¼Œä¸‹é¢è¿™ä¸ªä»£ç ä¹Ÿæ˜¯ç­‰ä»·çš„ï¼š

```javascript
// æ”¹å˜ let {...} ä¸­å…ƒç´ çš„é¡ºåº
let {height, width, title} = { title: "Menu", height: 200, width: 100 }
```

å¦‚æœæˆ‘ä»¬æƒ³æŠŠä¸€ä¸ªå±æ€§èµ‹å€¼ç»™å¦ä¸€ä¸ªåå­—çš„å˜é‡ï¼Œæ¯”å¦‚æŠŠ `options.width` å±æ€§èµ‹å€¼ç»™åä¸º `w` çš„å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†’å·æ¥è®¾ç½®å˜é‡åç§°ï¼š

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

// { sourceProperty: targetVariable }
let {width: w, height: h, title} = options;

// width -> w
// height -> h
// title -> title

alert(title);  // Menu
alert(w);      // 100
alert(h);      // 200
```

å†’å·çš„è¯­æ³•æ˜¯â€œä»å¯¹è±¡ä¸­ä»€ä¹ˆå±æ€§çš„å€¼ï¼šèµ‹å€¼ç»™å“ªä¸ªå˜é‡â€ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå±æ€§ `width` è¢«èµ‹å€¼ç»™äº† `w`ï¼Œå±æ€§ `height` è¢«èµ‹å€¼ç»™äº† `h`ï¼Œå±æ€§ `title` è¢«èµ‹å€¼ç»™äº†åŒåå˜é‡ã€‚

å¯¹äºå¯èƒ½ç¼ºå¤±çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `"="` è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
let options = {
  title: "Menu"
};

let {width = 100, height = 200, title} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
```

å°±åƒæ•°ç»„æˆ–å‡½æ•°å‚æ•°ä¸€æ ·ï¼Œé»˜è®¤å€¼å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ç”šè‡³å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨ã€‚å®ƒä»¬åªä¼šåœ¨æœªæä¾›å¯¹åº”çš„å€¼æ—¶æ‰ä¼šè¢«è®¡ç®—/è°ƒç”¨ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥å°†å†’å·å’Œç­‰å·ç»“åˆèµ·æ¥ï¼š

```javascript
let options = {
  title: "Menu"
};

let {width: w = 100, height: h = 200, title} = options;

alert(title);  // Menu
alert(w);      // 100
alert(h);      // 200
```

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå…·æœ‰å¾ˆå¤šå±æ€§çš„å¤æ‚å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åªæå–æ‰€éœ€çš„å†…å®¹ï¼š

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

// ä»…æå– title ä½œä¸ºå˜é‡
let { title } = options;

alert(title); // Menu
```

å¯ä»¥ä½¿ç”¨å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰ï¼š

```javascript
let options = {
  title: "Menu",
  height: 200,
  width: 100
};

// title = åä¸º title çš„å±æ€§
// rest = å­˜æœ‰å‰©ä½™å±æ€§çš„å¯¹è±¡
let {title, ...rest} = options;

// ç°åœ¨ title="Menu", rest={height: 200, width: 100}
alert(rest.height);  // 200
alert(rest.width);   // 100
```

> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå˜é‡éƒ½æ˜¯åœ¨èµ‹å€¼ä¸­é€šè¿‡æ­£ç¡®æ–¹å¼å£°æ˜çš„ï¼š`let {â€¦} = {â€¦}`ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å·²æœ‰çš„å˜é‡ï¼Œè€Œä¸ç”¨ `let`ï¼Œä½†è¿™é‡Œæœ‰ä¸€ä¸ªé™·é˜±ã€‚
>
> ä»¥ä¸‹ä»£ç æ— æ³•æ­£å¸¸è¿è¡Œï¼š
>
> ```javascript
> let title, width, height;
> 
> // è¿™ä¸€è¡Œå‘ç”Ÿäº†é”™è¯¯
> {title, width, height} = {title: "Menu", width: 200, height: 100};
> ```
>
> é—®é¢˜åœ¨äº JavaScript æŠŠä¸»ä»£ç æµï¼ˆå³ä¸åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­ï¼‰çš„ `{...}` å½“åšä¸€ä¸ªä»£ç å—ã€‚è¿™æ ·çš„ä»£ç å—å¯ä»¥ç”¨äºå¯¹è¯­å¥åˆ†ç»„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
>
> ```javascript
> {
>   // ä¸€ä¸ªä»£ç å—
>   let message = "Hello";
>   // ...
>   alert( message );
> }
> ```
>
> å› æ­¤ï¼Œè¿™é‡Œ JavaScript å‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªä»£ç å—ï¼Œè¿™å°±æ˜¯æŠ¥é”™çš„åŸå› ã€‚æˆ‘ä»¬éœ€è¦è§£æ„å®ƒã€‚
>
> ä¸ºäº†å‘Šè¯‰ JavaScript è¿™ä¸æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªèµ‹å€¼è¡¨è¾¾å¼ç”¨æ‹¬å· `(...)` åŒ…èµ·æ¥ï¼š
>
> ```javascript
> let title, width, height;
> 
> // ç°åœ¨å°±å¯ä»¥äº†
> ({title, width, height} = {title: "Menu", width: 200, height: 100});
> 
> alert( title ); // Menu
> ```

## åµŒå¥—è§£æ„

å¦‚æœä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„åµŒå¥—äº†å…¶ä»–çš„å¯¹è±¡å’Œæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç­‰å·å·¦ä¾§ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡å¼ï¼ˆpatternï¼‰æ¥æå–æ›´æ·±å±‚çš„æ•°æ®ã€‚

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œ`options` çš„å±æ€§ `size` æ˜¯å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå±æ€§ `items` æ˜¯å¦ä¸€ä¸ªæ•°ç»„ã€‚èµ‹å€¼è¯­å¥ä¸­ç­‰å·å·¦ä¾§çš„æ¨¡å¼ï¼ˆpatternï¼‰å…·æœ‰ç›¸åŒçš„ç»“æ„ä»¥ä»ä¸­æå–å€¼ï¼š

```javascript
let options = {
  size: {
    width: 100,
    height: 200
  },
  items: ["Cake", "Donut"],
  extra: true
};

// ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè§£æ„èµ‹å€¼è¯­å¥è¢«å†™æˆå¤šè¡Œçš„å½¢å¼
let {
  size: { // æŠŠ size èµ‹å€¼åˆ°è¿™é‡Œ
    width,
    height
  },
  items: [item1, item2], // æŠŠ items èµ‹å€¼åˆ°è¿™é‡Œ
  title = "Menu" // åœ¨å¯¹è±¡ä¸­ä¸å­˜åœ¨ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰
} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
alert(item1);  // Cake
alert(item2);  // Donut
```

å¯¹è±¡ `options` çš„æ‰€æœ‰å±æ€§ï¼Œé™¤äº† `extra` å±æ€§åœ¨ç­‰å·å·¦ä¾§ä¸å­˜åœ¨ï¼Œéƒ½è¢«èµ‹å€¼ç»™äº†å¯¹åº”çš„å˜é‡ã€‚æ³¨æ„ï¼Œ`size` å’Œ `items` æ²¡æœ‰å¯¹åº”çš„å˜é‡ï¼Œå› ä¸ºæˆ‘ä»¬å–çš„æ˜¯å®ƒä»¬çš„å†…å®¹ã€‚

## æ™ºèƒ½å‡½æ•°å‚æ•°

æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå¯¹è±¡æ¥ä¼ é€’æ‰€æœ‰å‚æ•°ï¼Œè€Œå‡½æ•°è´Ÿè´£æŠŠè¿™ä¸ªå¯¹è±¡è§£æ„æˆå„ä¸ªå‚æ•°ï¼š

```javascript
// æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå¯¹è±¡ç»™å‡½æ•°
let options = {
  title: "My menu",
  items: ["Item1", "Item2"]
};

// â€¦â€¦ç„¶åå‡½æ•°é©¬ä¸ŠæŠŠå¯¹è±¡è§£æ„æˆå˜é‡
function showMenu({title = "Untitled", width = 200, height = 100, items = []}) {
  // title, items â€“ æå–äº optionsï¼Œ
  // width, height â€“ ä½¿ç”¨é»˜è®¤å€¼
  alert( `${title} ${width} ${height}` ); // My Menu 200 100
  alert( items ); // Item1, Item2
}

showMenu(options);
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦æœ‰åµŒå¥—å¯¹è±¡å’Œå†’å·æ˜ å°„çš„æ›´åŠ å¤æ‚çš„è§£æ„ï¼š

```javascript
let options = {
  title: "My menu",
  items: ["Item1", "Item2"]
};

function showMenu({
  title = "Untitled",
  width: w = 100,  // width goes to w
  height: h = 200, // height goes to h
  items: [item1, item2] // items first element goes to item1, second to item2
}) {
  alert( `${title} ${w} ${h}` ); // My Menu 100 200
  alert( item1 ); // Item1
  alert( item2 ); // Item2
}

showMenu(options);
```

å®Œæ•´è¯­æ³•å’Œè§£æ„èµ‹å€¼æ˜¯ä¸€æ ·çš„ï¼š

```javascript
function({
  incomingProperty: varName = defaultValue
  ...
})
```

å¯¹äºå‚æ•°å¯¹è±¡ï¼Œå±æ€§ `incomingProperty` å¯¹åº”çš„å˜é‡æ˜¯ `varName`ï¼Œé»˜è®¤å€¼æ˜¯ `defaultValue`ã€‚

è¯·æ³¨æ„ï¼Œè¿™ç§è§£æ„å‡å®šäº† `showMenu()` å‡½æ•°ç¡®å®å­˜åœ¨å‚æ•°ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®©æ‰€æœ‰çš„å‚æ•°éƒ½ä½¿ç”¨é»˜è®¤å€¼ï¼Œé‚£æˆ‘ä»¬åº”è¯¥ä¼ é€’ä¸€ä¸ªç©ºå¯¹è±¡ï¼š

```javascript
showMenu({}); // ä¸é”™ï¼Œæ‰€æœ‰å€¼éƒ½å–é»˜è®¤å€¼

showMenu(); // è¿™æ ·ä¼šå¯¼è‡´é”™è¯¯
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šç©ºå¯¹è±¡ `{}` ä¸ºæ•´ä¸ªå‚æ•°å¯¹è±¡çš„é»˜è®¤å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```javascript
function showMenu({ title = "Menu", width = 100, height = 200 } = {}) {
  alert( `${title} ${width} ${height}` );
}

showMenu(); // Menu 100 200
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ•´ä¸ªå‚æ•°å¯¹è±¡çš„é»˜è®¤æ˜¯ `{}`ï¼Œå› æ­¤æ€»ä¼šæœ‰å†…å®¹å¯ä»¥ç”¨æ¥è§£æ„ã€‚

## æ€»ç»“

- è§£æ„èµ‹å€¼å¯ä»¥ç®€æ´åœ°å°†ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„æ‹†å¼€èµ‹å€¼åˆ°å¤šä¸ªå˜é‡ä¸Šã€‚

- è§£æ„å¯¹è±¡çš„å®Œæ•´è¯­æ³•ï¼š

  ```javascript
  let {prop : varName = default, ...rest} = object
  ```

  è¿™è¡¨ç¤ºå±æ€§ `prop` ä¼šè¢«èµ‹å€¼ç»™å˜é‡ `varName`ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå±æ€§çš„è¯ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤å€¼ `default`ã€‚

  æ²¡æœ‰å¯¹åº”æ˜ å°„çš„å¯¹è±¡å±æ€§ä¼šè¢«å¤åˆ¶åˆ° `rest` å¯¹è±¡ã€‚

- è§£æ„æ•°ç»„çš„å®Œæ•´è¯­æ³•ï¼š

  ```javascript
  let [item1 = default, item2, ...rest] = array
  ```

  æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«èµ‹å€¼ç»™ `item1`ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¢«èµ‹å€¼ç»™ `item2`ï¼Œå‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ è¢«å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ `rest`ã€‚

- ä»åµŒå¥—æ•°ç»„/å¯¹è±¡ä¸­æå–æ•°æ®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ­¤æ—¶ç­‰å·å·¦ä¾§å¿…é¡»å’Œç­‰å·å³ä¾§æœ‰ç›¸åŒçš„ç»“æ„ã€‚

# æ—¥æœŸå’Œæ—¶é—´

è¯¥å¯¹è±¡å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ï¼Œå¹¶æä¾›äº†æ—¥æœŸ/æ—¶é—´çš„ç®¡ç†æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å­˜å‚¨åˆ›å»º/ä¿®æ”¹æ—¶é—´ï¼Œæµ‹é‡æ—¶é—´ï¼Œæˆ–è€…ä»…ç”¨æ¥æ‰“å°å½“å‰æ—¶é—´ã€‚

## åˆ›å»º

`new Date()`

ä¸å¸¦å‚æ•° â€”â€” åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´çš„ `Date` å¯¹è±¡ï¼š

```javascript
let now = new Date();
alert( now ); // æ˜¾ç¤ºå½“å‰çš„æ—¥æœŸ/æ—¶é—´
```

`new Date(milliseconds)`

åˆ›å»ºä¸€ä¸ª `Date` å¯¹è±¡ï¼Œå…¶æ—¶é—´ç­‰äº 1970 å¹´ 1 æœˆ 1 æ—¥ UTC+0 ä¹‹åç»è¿‡çš„æ¯«ç§’æ•°ï¼ˆ1/1000 ç§’ï¼‰ã€‚

ä¼ å…¥çš„æ•´æ•°å‚æ•°ä»£è¡¨çš„æ˜¯è‡ª 1970-01-01 00:00:00 ä»¥æ¥ç»è¿‡çš„æ¯«ç§’æ•°ï¼Œè¯¥æ•´æ•°è¢«ç§°ä¸º **æ—¶é—´æˆ³**ã€‚

è¿™æ˜¯ä¸€ç§æ—¥æœŸçš„è½»é‡çº§æ•°å­—è¡¨ç¤ºå½¢å¼ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ `new Date(timestamp)` é€šè¿‡æ—¶é—´æˆ³æ¥åˆ›å»ºæ—¥æœŸï¼Œå¹¶å¯ä»¥ä½¿ç”¨ `date.getTime()` å°†ç°æœ‰çš„ `Date` å¯¹è±¡è½¬åŒ–ä¸ºæ—¶é—´æˆ³ï¼ˆä¸‹æ–‡ä¼šè®²åˆ°ï¼‰ã€‚

```javascript
// 0 è¡¨ç¤º 01.01.1970 UTC+0
let Jan01_1970 = new Date(0);
alert( Jan01_1970 );

// ç°åœ¨å¢åŠ  24 å°æ—¶ï¼Œå¾—åˆ° 02.01.1970 UTC+0
let Jan02_1970 = new Date(24 * 3600 * 1000);
alert( Jan02_1970 );
```

`new Date(datestring)`

å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è‡ªåŠ¨è§£æã€‚è¯¥ç®—æ³•ä¸ `Date.parse` æ‰€ä½¿ç”¨çš„ç®—æ³•ç›¸åŒï¼Œå°†åœ¨ä¸‹æ–‡ä¸­è¿›è¡Œä»‹ç»ã€‚

```javascript
let date = new Date("2017-01-26");
alert(date);
// æœªæŒ‡å®šå…·ä½“æ—¶é—´ï¼Œæ‰€ä»¥å‡å®šæ—¶é—´ä¸ºæ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´ï¼ˆGMTï¼‰çš„åˆå¤œé›¶ç‚¹
// å¹¶æ ¹æ®è¿è¡Œä»£ç æ—¶çš„ç”¨æˆ·çš„æ—¶åŒºè¿›è¡Œè°ƒæ•´
// å› æ­¤ï¼Œç»“æœå¯èƒ½æ˜¯
// Thu Jan 26 2017 11:00:00 GMT+1100 (Australian Eastern Daylight Time)
// æˆ–
// Wed Jan 25 2017 16:00:00 GMT-0800 (Pacific Standard Time)
```

`new Date(year, month, date, hours, minutes, seconds, ms)`

ä½¿ç”¨å½“å‰æ—¶åŒºä¸­çš„ç»™å®šç»„ä»¶åˆ›å»ºæ—¥æœŸã€‚åªæœ‰å‰ä¸¤ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚

- `year` åº”è¯¥æ˜¯å››ä½æ•°ã€‚ä¸ºäº†å…¼å®¹æ€§ï¼Œä¹Ÿæ¥å— 2 ä½æ•°ï¼Œå¹¶å°†å…¶è§†ä¸º `19xx`ï¼Œä¾‹å¦‚ `98` ä¸ `1998` ç›¸åŒï¼Œä½†å¼ºçƒˆå»ºè®®å§‹ç»ˆä½¿ç”¨ 4 ä½æ•°ã€‚
- `month` è®¡æ•°ä» `0`ï¼ˆä¸€æœˆï¼‰å¼€å§‹ï¼Œåˆ° `11`ï¼ˆåäºŒæœˆï¼‰ç»“æŸã€‚
- `date` æ˜¯å½“æœˆçš„å…·ä½“æŸä¸€å¤©ï¼Œå¦‚æœç¼ºå¤±ï¼Œåˆ™ä¸ºé»˜è®¤å€¼ `1`ã€‚
- å¦‚æœ `hours/minutes/seconds/ms` ç¼ºå¤±ï¼Œåˆ™å‡ä¸ºé»˜è®¤å€¼ `0`ã€‚

ä¾‹å¦‚ï¼š

```javascript
new Date(2011, 0, 1, 0, 0, 0, 0); // 1 Jan 2011, 00:00:00
new Date(2011, 0, 1); // åŒæ ·ï¼Œæ—¶åˆ†ç§’ç­‰å‡ä¸ºé»˜è®¤å€¼ 0
```

æ—¶é—´åº¦é‡æœ€å¤§ç²¾ç¡®åˆ° 1 æ¯«ç§’ï¼ˆ1/1000 ç§’ï¼‰ï¼š

```javascript
let date = new Date(2011, 0, 1, 2, 3, 4, 567);
alert( date ); // 1.01.2011, 02:03:04.567
```

## è®¿é—®æ—¥æœŸç»„ä»¶

ä» `Date` å¯¹è±¡ä¸­è®¿é—®å¹´ã€æœˆç­‰ä¿¡æ¯æœ‰å¤šç§æ–¹å¼ï¼š

- [getFullYear()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getFullYear)

  è·å–å¹´ä»½ï¼ˆ4 ä½æ•°ï¼‰

- [getMonth()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMonth)

  è·å–æœˆä»½ï¼Œ**ä» 0 åˆ° 11**ã€‚

- [getDate()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getDate)

  è·å–å½“æœˆçš„å…·ä½“æ—¥æœŸï¼Œä» 1 åˆ° 31ï¼Œè¿™ä¸ªæ–¹æ³•åç§°å¯èƒ½çœ‹èµ·æ¥æœ‰äº›ä»¤äººç–‘æƒ‘ã€‚

- [getHours()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getHours)ï¼Œ[getMinutes()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMinutes)ï¼Œ[getSeconds()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getSeconds)ï¼Œ[getMilliseconds()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMilliseconds)

  è·å–ç›¸åº”çš„æ—¶é—´ç»„ä»¶ã€‚

> **ä¸æ˜¯ `getYear()`ï¼Œè€Œæ˜¯ `getFullYear()`**
>
> å¾ˆå¤š JavaScript å¼•æ“éƒ½å®ç°äº†ä¸€ä¸ªéæ ‡å‡†åŒ–çš„æ–¹æ³• `getYear()`ã€‚ä¸æ¨èä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚å®ƒæœ‰æ—¶å€™å¯èƒ½ä¼šè¿”å› 2 ä½çš„å¹´ä»½ä¿¡æ¯ã€‚æ°¸è¿œä¸è¦ä½¿ç”¨å®ƒã€‚è¦è·å–å¹´ä»½å°±ä½¿ç”¨ `getFullYear()`ã€‚

å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è·å–ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼š

- [getDay()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getDay)

  è·å–ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼Œä» `0`ï¼ˆæ˜ŸæœŸæ—¥ï¼‰åˆ° `6`ï¼ˆæ˜ŸæœŸå…­ï¼‰ã€‚ç¬¬ä¸€å¤©å§‹ç»ˆæ˜¯æ˜ŸæœŸæ—¥ï¼Œåœ¨æŸäº›å›½å®¶å¯èƒ½ä¸æ˜¯è¿™æ ·çš„ä¹ æƒ¯ï¼Œä½†æ˜¯è¿™ä¸èƒ½è¢«æ”¹å˜ã€‚

**ä»¥ä¸Šçš„æ‰€æœ‰æ–¹æ³•è¿”å›çš„ç»„ä»¶éƒ½æ˜¯åŸºäºå½“åœ°æ—¶åŒºçš„ã€‚**

å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸å½“åœ°æ—¶åŒºçš„ UTC å¯¹åº”é¡¹ï¼Œå®ƒä»¬ä¼šè¿”å›åŸºäº UTC+0 æ—¶åŒºçš„æ—¥ã€æœˆã€å¹´ç­‰ï¼š[getUTCFullYear()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCFullYear)ï¼Œ[getUTCMonth()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCMonth)ï¼Œ[getUTCDay()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCDay)ã€‚åªéœ€è¦åœ¨ `"get"` ä¹‹åæ’å…¥ `"UTC"` å³å¯ã€‚

å¦‚æœä½ å½“åœ°æ—¶åŒºç›¸å¯¹äº UTC æœ‰åç§»ï¼Œé‚£ä¹ˆä¸‹é¢ä»£ç ä¼šæ˜¾ç¤ºä¸åŒçš„å°æ—¶æ•°ï¼š

```javascript
//  å½“å‰æ—¥æœŸ
let date = new Date();

// å½“åœ°æ—¶åŒºçš„å°æ—¶æ•°
alert( date.getHours() );

// åœ¨ UTC+0 æ—¶åŒºçš„å°æ—¶æ•°ï¼ˆéå¤ä»¤æ—¶çš„ä¼¦æ•¦æ—¶é—´ï¼‰
alert( date.getUTCHours() );
```

é™¤äº†ä¸Šè¿°ç»™å®šçš„æ–¹æ³•ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ²¡æœ‰ UTC å˜ä½“çš„ç‰¹æ®Šæ–¹æ³•ï¼š

- [getTime()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime)

  è¿”å›æ—¥æœŸçš„æ—¶é—´æˆ³ â€”â€” ä» 1970-1-1 00:00:00 UTC+0 å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚

- [getTimezoneOffset()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)

  è¿”å› UTC ä¸æœ¬åœ°æ—¶åŒºä¹‹é—´çš„æ—¶å·®ï¼Œä»¥åˆ†é’Ÿä¸ºå•ä½ï¼š

  ```javascript
  // å¦‚æœä½ åœ¨æ—¶åŒº UTC-1ï¼Œè¾“å‡º 60
  // å¦‚æœä½ åœ¨æ—¶åŒº UTC+3ï¼Œè¾“å‡º -180
  alert( new Date().getTimezoneOffset() );
  ```

## è®¾ç½®æ—¥æœŸç»„ä»¶

ä¸‹åˆ—æ–¹æ³•å¯ä»¥è®¾ç½®æ—¥æœŸ/æ—¶é—´ç»„ä»¶ï¼š

- [`setFullYear(year, [month\], [date])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setFullYear)
- [`setMonth(month, [date\])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMonth)
- [`setDate(date)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setDate)
- [`setHours(hour, [min\], [sec], [ms])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setHours)
- [`setMinutes(min, [sec\], [ms])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMinutes)
- [`setSeconds(sec, [ms\])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setSeconds)
- [`setMilliseconds(ms)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMilliseconds)
- [`setTime(milliseconds)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setTime)ï¼ˆä½¿ç”¨è‡ª 1970-01-01 00:00:00 UTC+0 ä»¥æ¥çš„æ¯«ç§’æ•°æ¥è®¾ç½®æ•´ä¸ªæ—¥æœŸï¼‰

ä»¥ä¸Šæ–¹æ³•é™¤äº† `setTime()` éƒ½æœ‰ UTC å˜ä½“ï¼Œä¾‹å¦‚ï¼š`setUTCHours()`ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰äº›æ–¹æ³•å¯ä»¥ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªç»„ä»¶ï¼Œæ¯”å¦‚ `setHours`ã€‚æœªæåŠçš„ç»„ä»¶ä¸ä¼šè¢«ä¿®æ”¹ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```javascript
let today = new Date();

today.setHours(0);
alert(today); // æ—¥æœŸä¾ç„¶æ˜¯ä»Šå¤©ï¼Œä½†æ˜¯å°æ—¶æ•°è¢«æ”¹ä¸ºäº† 0

today.setHours(0, 0, 0, 0);
alert(today); // æ—¥æœŸä¾ç„¶æ˜¯ä»Šå¤©ï¼Œæ—¶é—´ä¸º 00:00:00ã€‚
```

## è‡ªåŠ¨æ ¡å‡†

**è‡ªåŠ¨æ ¡å‡†** æ˜¯ `Date` å¯¹è±¡çš„ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ç‰¹æ€§ã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®è¶…èŒƒå›´çš„æ•°å€¼ï¼Œå®ƒä¼šè‡ªåŠ¨æ ¡å‡†ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```javascript
let date = new Date(2013, 0, 32); // 32 Jan 2013 ?!?
alert(date); // â€¦â€¦æ˜¯ 1st Feb 2013!
```

è¶…å‡ºèŒƒå›´çš„æ—¥æœŸç»„ä»¶å°†ä¼šè¢«è‡ªåŠ¨åˆ†é…ã€‚

å‡è®¾æˆ‘ä»¬è¦åœ¨æ—¥æœŸ â€œ28 Feb 2016â€ ä¸ŠåŠ  2 å¤©ã€‚ç»“æœå¯èƒ½æ˜¯ â€œ2 Marâ€ æˆ– â€œ1 Marâ€ï¼Œå› ä¸ºå­˜åœ¨é—°å¹´ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘è¿™äº›ï¼Œåªéœ€è¦ç›´æ¥åŠ  2 å¤©ï¼Œå‰©ä¸‹çš„ `Date` å¯¹è±¡ä¼šå¸®æˆ‘ä»¬å¤„ç†ï¼š

```javascript
let date = new Date(2016, 1, 28);
date.setDate(date.getDate() + 2);

alert( date ); // 1 Mar 2016
```

è¿™ä¸ªç‰¹æ€§ç»å¸¸è¢«ç”¨æ¥è·å–ç»™å®šæ—¶é—´æ®µåçš„æ—¥æœŸã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è·å–â€œç°åœ¨ 70 ç§’åâ€çš„æ—¥æœŸï¼š

```javascript
let date = new Date();
date.setSeconds(date.getSeconds() + 70);

alert( date ); // æ˜¾ç¤ºæ­£ç¡®çš„æ—¥æœŸä¿¡æ¯
```

æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½® 0 ç”šè‡³å¯ä»¥è®¾ç½®è´Ÿå€¼ã€‚ä¾‹å¦‚ï¼š

```javascript
let date = new Date(2016, 0, 2); // 2016 å¹´ 1 æœˆ 2 æ—¥

date.setDate(1); // è®¾ç½®ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤©
alert( date );

date.setDate(0); // å¤©æ•°æœ€å°å¯ä»¥è®¾ç½®ä¸º 1ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®çš„æ˜¯ä¸Šä¸€æœˆçš„æœ€åä¸€å¤©
alert( date ); // 31 Dec 2015
```

## æ—¥æœŸè½¬åŒ–ä¸ºæ•°å­—

å½“ `Date` å¯¹è±¡è¢«è½¬åŒ–ä¸ºæ•°å­—æ—¶ï¼Œå¾—åˆ°çš„æ˜¯å¯¹åº”çš„æ—¶é—´æˆ³ï¼Œä¸ä½¿ç”¨ `date.getTime()` çš„ç»“æœç›¸åŒï¼š

```javascript
let date = new Date();
alert(+date); // ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ•°å€¼ï¼Œä¸ä½¿ç”¨ date.getTime() çš„ç»“æœç›¸åŒ
```

æœ‰ä¸€ä¸ªé‡è¦çš„å‰¯ä½œç”¨ï¼šæ—¥æœŸå¯ä»¥ç›¸å‡ï¼Œç›¸å‡çš„ç»“æœæ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½æ—¶é—´å·®ã€‚

è¿™ä¸ªä½œç”¨å¯ä»¥ç”¨äºæ—¶é—´æµ‹é‡ï¼š

```javascript
let start = new Date(); // å¼€å§‹æµ‹é‡æ—¶é—´

// do the job
for (let i = 0; i < 100000; i++) {
  let doSomething = i * i * i;
}

let end = new Date(); // ç»“æŸæµ‹é‡æ—¶é—´

alert( `The loop took ${end - start} ms` );
```

## `Date.now()`

å¦‚æœæˆ‘ä»¬ä»…ä»…æƒ³è¦æµ‹é‡æ—¶é—´é—´éš”ï¼Œæˆ‘ä»¬ä¸éœ€è¦ `Date` å¯¹è±¡ã€‚

æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• `Date.now()`ï¼Œå®ƒä¼šè¿”å›å½“å‰çš„æ—¶é—´æˆ³ã€‚

å®ƒç›¸å½“äº `new Date().getTime()`ï¼Œä½†å®ƒä¸ä¼šåˆ›å»ºä¸­é—´çš„ `Date` å¯¹è±¡ã€‚å› æ­¤å®ƒæ›´å¿«ï¼Œè€Œä¸”ä¸ä¼šå¯¹åƒåœ¾å›æ”¶é€ æˆé¢å¤–çš„å‹åŠ›ã€‚

è¿™ç§æ–¹æ³•å¾ˆå¤šæ—¶å€™å› ä¸ºæ–¹ä¾¿ï¼Œåˆæˆ–æ˜¯å› æ€§èƒ½æ–¹é¢çš„è€ƒè™‘è€Œè¢«é‡‡ç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨ JavaScript ç¼–å†™æ¸¸æˆæˆ–å…¶ä»–çš„ç‰¹æ®Šåº”ç”¨åœºæ™¯ã€‚

å› æ­¤è¿™æ ·åšå¯èƒ½ä¼šæ›´å¥½ï¼š

```javascript
let start = Date.now(); // ä» 1 Jan 1970 è‡³ä»Šçš„æ—¶é—´æˆ³

// do the job
for (let i = 0; i < 100000; i++) {
  let doSomething = i * i * i;
}

let end = Date.now(); // å®Œæˆ

alert( `The loop took ${end - start} ms` ); // ç›¸å‡çš„æ˜¯æ—¶é—´æˆ³ï¼Œè€Œä¸æ˜¯æ—¥æœŸ
```

## åŸºå‡†æµ‹è¯•

æˆ‘ä»¬æƒ³åˆ¤æ–­ä»¥ä¸‹ä¸¤ä¸ªè®¡ç®—æ—¥æœŸå·®å€¼çš„å‡½æ•°ï¼šå“ªä¸ªæ›´å¿«ï¼Ÿè¿™ç§æ€§èƒ½æµ‹é‡é€šå¸¸ç§°ä¸ºâ€œåŸºå‡†æµ‹è¯•ï¼ˆbenchmarkï¼‰â€ã€‚**ä¸ºäº†å¾—åˆ°æ›´åŠ å¯é çš„åº¦é‡ï¼Œæ•´ä¸ªåº¦é‡æµ‹è¯•åŒ…åº”è¯¥é‡æ–°è¿è¡Œå¤šæ¬¡ã€‚**

## `Date.parse`

[Date.parse(str)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/parse) æ–¹æ³•å¯ä»¥ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¯»å–æ—¥æœŸã€‚

å­—ç¬¦ä¸²çš„æ ¼å¼åº”è¯¥ä¸ºï¼š`YYYY-MM-DDTHH:mm:ss.sssZ`ï¼Œå…¶ä¸­ï¼š

- `YYYY-MM-DD` â€”â€” æ—¥æœŸï¼šå¹´-æœˆ-æ—¥ã€‚
- å­—ç¬¦ `"T"` æ˜¯ä¸€ä¸ªåˆ†éš”ç¬¦ã€‚
- `HH:mm:ss.sss` â€”â€” æ—¶é—´ï¼šå°æ—¶ï¼Œåˆ†é’Ÿï¼Œç§’ï¼Œæ¯«ç§’ã€‚
- å¯é€‰å­—ç¬¦ `'Z'` ä¸º `+-hh:mm` æ ¼å¼çš„æ—¶åŒºã€‚å•ä¸ªå­—ç¬¦ `Z` ä»£è¡¨ UTC+0 æ—¶åŒºã€‚

ç®€çŸ­å½¢å¼ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚ `YYYY-MM-DD` æˆ– `YYYY-MM`ï¼Œç”šè‡³å¯ä»¥æ˜¯ `YYYY`ã€‚

`Date.parse(str)` è°ƒç”¨ä¼šè§£æç»™å®šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ—¶é—´æˆ³ï¼ˆè‡ª 1970-01-01 00:00:00 èµ·æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼‰ã€‚å¦‚æœç»™å®šå­—ç¬¦ä¸²çš„æ ¼å¼ä¸æ­£ç¡®ï¼Œåˆ™è¿”å› `NaN`ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```javascript
let ms = Date.parse('2012-01-26T13:51:50.417-07:00');

alert(ms); // 1327611110417  (æ—¶é—´æˆ³)
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ—¶é—´æˆ³æ¥ç«‹å³åˆ›å»ºä¸€ä¸ª `new Date` å¯¹è±¡ï¼š

```javascript
let date = new Date( Date.parse('2012-01-26T13:51:50.417-07:00') );

alert(date);
```

## æ€»ç»“

- åœ¨ JavaScript ä¸­ï¼Œæ—¥æœŸå’Œæ—¶é—´ä½¿ç”¨ [Date](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date) å¯¹è±¡æ¥è¡¨ç¤ºã€‚æˆ‘ä»¬ä¸èƒ½å•ç‹¬åˆ›å»ºæ—¥æœŸæˆ–æ—¶é—´ï¼Œ`Date` å¯¹è±¡æ€»æ˜¯åŒæ—¶åˆ›å»ºä¸¤è€…ã€‚
- æœˆä»½ä» 0 å¼€å§‹è®¡æ•°ï¼ˆå¯¹ï¼Œä¸€æœˆæ˜¯ 0ï¼‰ã€‚
- ä¸€å‘¨ä¸­çš„æŸä¸€å¤© `getDay()` åŒæ ·ä» 0 å¼€å§‹è®¡ç®—ï¼ˆ0 ä»£è¡¨æ˜ŸæœŸæ—¥ï¼‰ã€‚
- å½“è®¾ç½®äº†è¶…å‡ºèŒƒå›´çš„ç»„ä»¶æ—¶ï¼Œ`Date` ä¼šè¿›è¡Œè‡ªåŠ¨æ ¡å‡†ã€‚è¿™ä¸€ç‚¹å¯¹äºæ—¥/æœˆ/å°æ—¶çš„åŠ å‡å¾ˆæœ‰ç”¨ã€‚
- æ—¥æœŸå¯ä»¥ç›¸å‡ï¼Œå¾—åˆ°çš„æ˜¯ä»¥æ¯«ç§’è¡¨ç¤ºçš„ä¸¤è€…çš„å·®å€¼ã€‚å› ä¸ºå½“ `Date` è¢«è½¬æ¢ä¸ºæ•°å­—æ—¶ï¼Œ`Date` å¯¹è±¡ä¼šè¢«è½¬æ¢ä¸ºæ—¶é—´æˆ³ã€‚
- ä½¿ç”¨ `Date.now()` å¯ä»¥æ›´å¿«åœ°è·å–å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ã€‚

å’Œå…¶ä»–ç³»ç»Ÿä¸åŒï¼ŒJavaScript ä¸­æ—¶é—´æˆ³ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œè€Œä¸æ˜¯ç§’ã€‚

æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›´åŠ ç²¾å‡†çš„æ—¶é—´åº¦é‡ã€‚JavaScript è‡ªèº«å¹¶æ²¡æœ‰æµ‹é‡å¾®ç§’çš„æ–¹æ³•ï¼ˆç™¾ä¸‡åˆ†ä¹‹ä¸€ç§’ï¼‰ï¼Œä½†å¤§å¤šæ•°è¿è¡Œç¯å¢ƒä¼šæä¾›ã€‚ä¾‹å¦‚ï¼šæµè§ˆå™¨æœ‰ [performance.now()](https://developer.mozilla.org/zh/docs/Web/API/Performance/now) æ–¹æ³•æ¥ç»™å‡ºä»é¡µé¢åŠ è½½å¼€å§‹çš„ä»¥æ¯«ç§’ä¸ºå•ä½çš„å¾®ç§’æ•°ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’çš„å°æ•°ç‚¹åä¸‰ä½ï¼‰ï¼š

```javascript
alert(`Loading started ${performance.now()}ms ago`);
// ç±»ä¼¼äº "Loading started 34731.26000000001ms ago"
// .26 è¡¨ç¤ºçš„æ˜¯å¾®ç§’ï¼ˆ260 å¾®ç§’ï¼‰
// å°æ•°ç‚¹åè¶…è¿‡ 3 ä½çš„æ•°å­—æ˜¯ç²¾åº¦é”™è¯¯ï¼Œåªæœ‰å‰ä¸‰ä½æ•°å­—æ˜¯æ­£ç¡®çš„
```

Node.js å¯ä»¥é€šè¿‡ `microtime` æ¨¡å—æˆ–ä½¿ç”¨å…¶ä»–æ–¹æ³•ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œå‡ ä¹æ‰€æœ‰çš„è®¾å¤‡å’Œç¯å¢ƒéƒ½å…è®¸è·å–æ›´é«˜ç²¾åº¦çš„æ—¶é—´æ•°å€¼ï¼Œåªä¸è¿‡ä¸æ˜¯ä½¿ç”¨ `Date` å¯¹è±¡ã€‚

# JSONæ–¹æ³•

[JSON](https://en.wikipedia.org/wiki/JSON)ï¼ˆJavaScript Object Notationï¼‰æ˜¯è¡¨ç¤ºå€¼å’Œå¯¹è±¡çš„é€šç”¨æ ¼å¼ã€‚åœ¨ [RFC 4627](https://tools.ietf.org/html/rfc4627) æ ‡å‡†ä¸­æœ‰å¯¹å…¶çš„æè¿°ã€‚æœ€åˆå®ƒæ˜¯ä¸º JavaScript è€Œåˆ›å»ºçš„ï¼Œä½†è®¸å¤šå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¹Ÿæœ‰ç”¨äºå¤„ç†å®ƒçš„åº“ã€‚å› æ­¤ï¼Œå½“å®¢æˆ·ç«¯ä½¿ç”¨ JavaScript è€ŒæœåŠ¡å™¨ç«¯æ˜¯ä½¿ç”¨ Ruby/PHP/Java ç­‰è¯­è¨€ç¼–å†™çš„æ—¶ï¼Œä½¿ç”¨ JSON å¯ä»¥å¾ˆå®¹æ˜“åœ°è¿›è¡Œæ•°æ®äº¤æ¢ã€‚

JavaScript æä¾›äº†å¦‚ä¸‹æ–¹æ³•ï¼š

- `JSON.stringify` å°†å¯¹è±¡è½¬æ¢ä¸º JSONã€‚
- `JSON.parse` å°† JSON è½¬æ¢å›å¯¹è±¡ã€‚

##  `JSON.stringify`

æ–¹æ³• `JSON.stringify` æ¥æ”¶å¯¹è±¡å¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

å¾—åˆ°çš„ `json` å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªè¢«ç§°ä¸º **JSON ç¼–ç ï¼ˆJSON-encodedï¼‰** æˆ– **åºåˆ—åŒ–ï¼ˆserializedï¼‰** æˆ– **å­—ç¬¦ä¸²åŒ–ï¼ˆstringifiedï¼‰** æˆ– **ç¼–ç»„åŒ–ï¼ˆmarshalledï¼‰** çš„å¯¹è±¡ã€‚æˆ‘ä»¬ç°åœ¨å·²ç»å‡†å¤‡å¥½é€šè¿‡æœ‰çº¿å‘é€å®ƒæˆ–å°†å…¶æ”¾å…¥æ™®é€šæ•°æ®å­˜å‚¨ã€‚

è¯·æ³¨æ„ï¼ŒJSON ç¼–ç çš„å¯¹è±¡ä¸å¯¹è±¡å­—é¢é‡æœ‰å‡ ä¸ªé‡è¦çš„åŒºåˆ«ï¼š

- å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·ã€‚JSON ä¸­æ²¡æœ‰å•å¼•å·æˆ–åå¼•å·ã€‚æ‰€ä»¥ `'John'` è¢«è½¬æ¢ä¸º `"John"`ã€‚
- å¯¹è±¡å±æ€§åç§°ä¹Ÿæ˜¯åŒå¼•å·çš„ã€‚è¿™æ˜¯å¼ºåˆ¶æ€§çš„ã€‚æ‰€ä»¥ `age:30` è¢«è½¬æ¢æˆ `"age":30`ã€‚

`JSON.stringify` ä¹Ÿå¯ä»¥åº”ç”¨äºåŸå§‹ï¼ˆprimitiveï¼‰æ•°æ®ç±»å‹ã€‚

JSON æ”¯æŒä»¥ä¸‹æ•°æ®ç±»å‹ï¼š

- Objects `{ ... }`
- Arrays `[ ... ]`
- Primitivesï¼š
  - stringsï¼Œ
  - numbersï¼Œ
  - boolean values `true/false`ï¼Œ
  - `null`ã€‚

JSON æ˜¯è¯­è¨€æ— å…³çš„çº¯æ•°æ®è§„èŒƒï¼Œå› æ­¤ä¸€äº›ç‰¹å®šäº JavaScript çš„å¯¹è±¡å±æ€§ä¼šè¢« `JSON.stringify` è·³è¿‡ã€‚

å³ï¼š

- å‡½æ•°å±æ€§ï¼ˆæ–¹æ³•ï¼‰ã€‚
- Symbol ç±»å‹çš„é”®å’Œå€¼ã€‚
- å­˜å‚¨ `undefined` çš„å±æ€§ã€‚

é‡è¦çš„é™åˆ¶ï¼šä¸å¾—æœ‰å¾ªç¯å¼•ç”¨ã€‚ä¾‹å¦‚ï¼š

```javascript
let room = {
  number: 23
};

let meetup = {
  title: "Conference",
  participants: ["john", "ann"]
};

meetup.place = room;       // meetup å¼•ç”¨äº† room
room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

JSON.stringify(meetup); // Error: Converting circular structure to JSON
```

## æ’é™¤å’Œè½¬æ¢

`JSON.stringify` çš„å®Œæ•´è¯­æ³•æ˜¯ï¼š

```javascript
let json = JSON.stringify(value[, replacer, space])
```

- value

  è¦ç¼–ç çš„å€¼ã€‚

- replacer

  è¦ç¼–ç çš„å±æ€§æ•°ç»„æˆ–æ˜ å°„å‡½æ•° `function(key, value)`ã€‚

- space

  ç”¨äºæ ¼å¼åŒ–çš„ç©ºæ ¼æ•°é‡ã€‚

å¤§éƒ¨åˆ†æƒ…å†µï¼Œ`JSON.stringify` ä»…ä¸ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¾®è°ƒæ›¿æ¢è¿‡ç¨‹ï¼Œæ¯”å¦‚è¿‡æ»¤æ‰å¾ªç¯å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `JSON.stringify` çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚

å¦‚æœæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå±æ€§æ•°ç»„ç»™å®ƒï¼Œé‚£ä¹ˆåªæœ‰è¿™äº›å±æ€§ä¼šè¢«ç¼–ç ã€‚

```
let room = {
  number: 23
};

let meetup = {
  title: "Conference",
  participants: [{name: "John"}, {name: "Alice"}],
  place: room // meetup å¼•ç”¨äº† room
};

room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

alert( JSON.stringify(meetup, ['title', 'participants']) );
// {"title":"Conference","participants":[{},{}]}
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ä»£æ›¿æ•°ç»„ä½œä¸º `replacer`ã€‚è¯¥å‡½æ•°ä¼šä¸ºæ¯ä¸ª `(key,value)` å¯¹è°ƒç”¨å¹¶è¿”å›â€œå·²æ›¿æ¢â€çš„å€¼ï¼Œè¯¥å€¼å°†æ›¿æ¢åŸæœ‰çš„å€¼ã€‚å¦‚æœå€¼è¢«è·³è¿‡äº†ï¼Œåˆ™ä¸º `undefined`ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º `occupiedBy` ä»¥å¤–çš„æ‰€æœ‰å†…å®¹æŒ‰åŸæ ·è¿”å› `value`ã€‚å¯¹äº `occupiedBy`ï¼Œä¸‹é¢çš„ä»£ç è¿”å› `undefined`ï¼š

```javascript
let room = {
  number: 23
};

let meetup = {
  title: "Conference",
  participants: [{name: "John"}, {name: "Alice"}],
  place: room // meetup å¼•ç”¨äº† room
};

room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

alert( JSON.stringify(meetup, function replacer(key, value) {
  alert(`${key}: ${value}`);
  return (key == 'occupiedBy') ? undefined : value;
}));

/* key:value pairs that come to replacer:
:             [object Object]
title:        Conference
participants: [object Object],[object Object]
0:            [object Object]
name:         John
1:            [object Object]
name:         Alice
place:        [object Object]
number:       23
occupiedBy: [object Object]
*/
```

è¯·æ³¨æ„ `replacer` å‡½æ•°ä¼šè·å–æ¯ä¸ªé”®/å€¼å¯¹ï¼ŒåŒ…æ‹¬åµŒå¥—å¯¹è±¡å’Œæ•°ç»„é¡¹ã€‚å®ƒè¢«é€’å½’åœ°åº”ç”¨ã€‚`replacer` ä¸­çš„ `this` çš„å€¼æ˜¯åŒ…å«å½“å‰å±æ€§çš„å¯¹è±¡ã€‚

ç¬¬ä¸€ä¸ªè°ƒç”¨å¾ˆç‰¹åˆ«ã€‚å®ƒæ˜¯ä½¿ç”¨ç‰¹æ®Šçš„â€œåŒ…è£…å¯¹è±¡â€åˆ¶ä½œçš„ï¼š`{"": meetup}`ã€‚æ¢å¥è¯è¯´ï¼Œç¬¬ä¸€ä¸ª `(key, value)` å¯¹çš„é”®æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”è¯¥å€¼æ˜¯æ•´ä¸ªç›®æ ‡å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä¸­ç¬¬ä¸€è¡Œæ˜¯ `":[object Object]"` çš„åŸå› ã€‚

è¿™ä¸ªç†å¿µæ˜¯ä¸ºäº†ç»™ `replacer` æä¾›å°½å¯èƒ½å¤šçš„åŠŸèƒ½ï¼šå¦‚æœæœ‰å¿…è¦ï¼Œå®ƒæœ‰æœºä¼šåˆ†æå¹¶æ›¿æ¢/è·³è¿‡æ•´ä¸ªå¯¹è±¡ã€‚

### æ’é™¤åå‘å¼•ç”¨

åœ¨ç®€å•å¾ªç¯å¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åç§°æ’é™¤åºåˆ—åŒ–ä¸­è¿è§„çš„å±æ€§ã€‚

ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬ä¸èƒ½åªä½¿ç”¨åç§°ï¼Œå› ä¸ºå®ƒæ—¢å¯èƒ½åœ¨å¾ªç¯å¼•ç”¨ä¸­ä¹Ÿå¯èƒ½åœ¨å¸¸è§„å±æ€§ä¸­ä½¿ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å±æ€§å€¼æ¥æ£€æŸ¥å±æ€§ã€‚

```javascript
let room = {
  number: 23
};

let meetup = {
  title: "Conference",
  occupiedBy: [{name: "John"}, {name: "Alice"}],
  place: room
};

room.occupiedBy = meetup;
meetup.self = meetup;

alert( JSON.stringify(meetup, function replacer(key, value) {
  return (key != "" && value == meetup) ? undefined : value;
}));

```

è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦åˆ¤æ–­ `key==""` ä»¥æ’é™¤ç¬¬ä¸€ä¸ªè°ƒç”¨æ—¶ `value` æ˜¯ `meetup` çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¸‹å¦‚æœä¸åˆ¤æ–­è¯¥æ¡ä»¶ï¼Œç”±äºroomå’Œmeetupä¸¤è€…çš„valueéƒ½åŒ…å«meetupï¼Œå‡ä¼šè¿”å›undefinedï¼Œæœ€åçš„ç»“æœä¹Ÿæ˜¯undefinedã€‚

## æ ¼å¼åŒ–

`JSON.stringify(value, replacer, spaces)` çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç”¨äºä¼˜åŒ–æ ¼å¼çš„ç©ºæ ¼æ•°é‡ã€‚

ä»¥å‰ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²åŒ–çš„å¯¹è±¡éƒ½æ²¡æœ‰ç¼©è¿›å’Œé¢å¤–çš„ç©ºæ ¼ã€‚å¦‚æœæˆ‘ä»¬æƒ³é€šè¿‡ç½‘ç»œå‘é€ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±æ²¡ä»€ä¹ˆé—®é¢˜ã€‚`space` å‚æ•°ä¸“é—¨ç”¨äºè°ƒæ•´å‡ºæ›´ç¾è§‚çš„è¾“å‡ºã€‚

è¿™é‡Œçš„ `space = 2` å‘Šè¯‰ JavaScript åœ¨å¤šè¡Œä¸­æ˜¾ç¤ºåµŒå¥—çš„å¯¹è±¡ï¼Œå¯¹è±¡å†…éƒ¨ç¼©è¿› 2 ä¸ªç©ºæ ¼ï¼š

```
let user = {
  name: "John",
  age: 25,
  roles: {
    isAdmin: false,
    isEditor: true
  }
};

alert(JSON.stringify(user, null, 2));
```

## è‡ªå®šä¹‰`toJSON`

åƒ `toString` è¿›è¡Œå­—ç¬¦ä¸²è½¬æ¢ï¼Œå¯¹è±¡ä¹Ÿå¯ä»¥æä¾› `toJSON` æ–¹æ³•æ¥è¿›è¡Œ JSON è½¬æ¢ã€‚å¦‚æœå¯ç”¨ï¼Œ`JSON.stringify` ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒã€‚

```
let room = {
  number: 23,
  toJSON() {
    return this.number;
  }
};

let meetup = {
  title: "Conference",
  room
};

alert( JSON.stringify(room) ); // 23

alert( JSON.stringify(meetup) );
/*
  {
    "title":"Conference",
    "room": 23
  }
*/
```

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œ`toJSON` æ—¢å¯ä»¥ç”¨äºç›´æ¥è°ƒç”¨ `JSON.stringify(room)` ä¹Ÿå¯ä»¥ç”¨äºå½“ `room` åµŒå¥—åœ¨å¦ä¸€ä¸ªç¼–ç å¯¹è±¡ä¸­æ—¶ã€‚

## `JSON.parse`

```javascript
let value = JSON.parse(str, [reviver]);
```

- str

  è¦è§£æçš„ JSON å­—ç¬¦ä¸²ã€‚

- reviver

  å¯é€‰çš„å‡½æ•° function(key,value)ï¼Œè¯¥å‡½æ•°å°†ä¸ºæ¯ä¸ª `(key, value)` å¯¹è°ƒç”¨ï¼Œå¹¶å¯ä»¥å¯¹å€¼è¿›è¡Œè½¬æ¢ã€‚

ä¾‹å¦‚ï¼š

```javascript
// å­—ç¬¦ä¸²åŒ–æ•°ç»„
let numbers = "[0, 1, 2, 3]";

numbers = JSON.parse(numbers);

alert( numbers[1] ); // 1
```

å¯¹äºåµŒå¥—å¯¹è±¡ï¼š

```javascript
let userData = '{ "name": "John", "age": 35, "isAdmin": false, "friends": [0,1,2,3] }';

let user = JSON.parse(userData);

alert( user.friends[1] ); // 1
```

JSON å¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œå¯¹è±¡å’Œæ•°ç»„å¯ä»¥åŒ…å«å…¶ä»–å¯¹è±¡å’Œæ•°ç»„ã€‚ä½†æ˜¯å®ƒä»¬å¿…é¡»éµå¾ªç›¸åŒçš„ JSON æ ¼å¼ã€‚

## `reviver`

`meetup.date` çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ `Date` å¯¹è±¡ã€‚`JSON.parse` æ€ä¹ˆçŸ¥é“åº”è¯¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º `Date` å‘¢ï¼Ÿ

è®©æˆ‘ä»¬å°† reviver å‡½æ•°ä¼ é€’ç»™ `JSON.parse` ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¯¥å‡½æ•°æŒ‰ç…§â€œåŸæ ·â€è¿”å›æ‰€æœ‰å€¼ï¼Œä½†æ˜¯ `date` ä¼šå˜æˆ `Date`ï¼š

```javascript
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';

let meetup = JSON.parse(str, function(key, value) {
  if (key == 'date') return new Date(value);
  return value;
});

alert( meetup.date.getDate() ); // ç°åœ¨æ­£å¸¸è¿è¡Œäº†ï¼
```

é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™ä¹Ÿé€‚ç”¨äºåµŒå¥—å¯¹è±¡ï¼š

```javascript
let schedule = `{
  "meetups": [
    {"title":"Conference","date":"2017-11-30T12:00:00.000Z"},
    {"title":"Birthday","date":"2017-04-18T12:00:00.000Z"}
  ]
}`;

schedule = JSON.parse(schedule, function(key, value) {
  if (key == 'date') return new Date(value);
  return value;
});

alert( schedule.meetups[1].date.getDate() ); // æ­£å¸¸è¿è¡Œäº†ï¼
```

## æ€»ç»“

- JSON æ˜¯ä¸€ç§æ•°æ®æ ¼å¼ï¼Œå…·æœ‰è‡ªå·±çš„ç‹¬ç«‹æ ‡å‡†å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€çš„åº“ã€‚
- JSON æ”¯æŒ objectï¼Œarrayï¼Œstringï¼Œnumberï¼Œboolean å’Œ `null`ã€‚
- JavaScript æä¾›åºåˆ—åŒ–ï¼ˆserializeï¼‰æˆ JSON çš„æ–¹æ³• [JSON.stringify](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify) å’Œè§£æ JSON çš„æ–¹æ³• [JSON.parse](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)ã€‚
- è¿™ä¸¤ç§æ–¹æ³•éƒ½æ”¯æŒç”¨äºæ™ºèƒ½è¯»/å†™çš„è½¬æ¢å‡½æ•°ã€‚
- å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰ `toJSON`ï¼Œé‚£ä¹ˆå®ƒä¼šè¢« `JSON.stringify` è°ƒç”¨ã€‚